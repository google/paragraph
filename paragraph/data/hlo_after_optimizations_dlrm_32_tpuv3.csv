# Operation per operation execution times of MLPerf(TM)'s training v0.7's Dlrm benchmark running on a TPU v3 system.
# Please, follow MLPerf(TM)'s publication guidelines when citing this data (https://github.com/mlcommons/policies/blob/master/RESULTS_GUIDELINES.md).
Rank,Category,HLO op,TF op,#Occurrences,Total time (us),Avg. time (us),Total self time (us),Avg. self time (us),Total self time (%),Cumulative total self time (%),%time stalled by DMA,Measured GFLOP/s,Measured Memory BW (GiB/s),Operational Intensity (FLOP/Byte),Bound by,HLO Rematerialization,Outside Compilation
1,all-reduce,"%all-reduce.92 = (f32[19656,128]{1,0:T(8,128)}, f32[512]{0:T(512)}, f32[13,512]{1,0:T(8,128)}, f32[256]{0:T(256)}, f32[512,256]{1,0:T(8,128)}, /*index=5*/f32[128]{0:T(256)}, f32[256,128]{1,0:T(8,128)}, f32[1024]{0:T(1024)}, f32[857,1024]{1,0:T(8,128)}, f32[1024]{0:T(1024)}, /*index=10*/f32[1024,1024]{1,0:T(8,128)}, f32[512]{0:T(512)}, f32[1024,512]{1,0:T(8,128)}, f32[256]{0:T(256)}, f32[512,256]{1,0:T(8,128)}, /*index=15*/f32[1]{0:T(256)}, f32[256,1]{0,1:T(2,128)}) all-reduce(f32[19656,128]{1,0:T(8,128)} %fusion.1373, f32[512]{0:T(512)} %get-tuple-element.2764, f32[13,512]{1,0:T(8,128)} %convolution.401, f32[256]{0:T(256)} %get-tuple-element.2766, f32[512,256]{1,0:T(8,128)} %convolution.402, f32[128]{0:T(256)} %get-tuple-element.2767, f32[256,128]{1,0:T(8,128)} %convolution.403, f32[1024]{0:T(1024)} %get-tuple-element.2768, f32[857,1024]{1,0:T(8,128)} %fusion.1378, f32[1024]{0:T(1024)} %get-tuple-element.2769, f32[1024,1024]{1,0:T(8,128)} %convolution.405, f32[512]{0:T(512)} %get-tuple-element.2770, f32[1024,512]{1,0:T(8,128)} %convolution.406, f32[256]{0:T(256)} %get-tuple-element.2771, f32[512,256]{1,0:T(8,128)} %fusion.1380, f32[1]{0:T(256)} %bitcast.111, f32[256,1]{0,1:T(2,128)} %reshape.413), replica_groups={{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63}}, to_apply=%sum.200",,155982,72968359.315711,467.79986995750153,72968359.315711,467.79986995750153,0.37823266548482132,0.37823266548482132,0,11.269641867320191,84.11417963469107,0.124778865161476,HBM,No,No
2,custom fusion,"%fusion.1373 = f32[19656,128]{1,0:T(8,128)} fusion(s32[1664]{0:T(1024)} %reshape.400, f32[1664,128]{1,0:T(8,128)} %reshape.410, f32[]{:T(256)} %get-tuple-element.3597), kind=kCustom, calls=%fused_computation.4.clone",while/training/UnsortedSegmentSum:UnsortedSegmentSum,155978,11693381.472856,74.968145974791312,11693381.472856,74.968145974791312,0.060612831157036341,0.43884549664185768,0,2.8411000062829403,135.72099388852135,0.019495735307901395,HBM,No,No
3,loop fusion,"%fusion.1382 = f32[19656,128]{1,0:T(8,128)} fusion(f32[19656,128]{1,0:T(8,128)} %get-tuple-element.3546, f32[19656,128]{1,0:T(8,128)} %get-tuple-element.2773, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.3.clone",while/training/train/update_tc_embedding_table/ResourceApplyGradientDescent:ResourceApplyGradientDescent,117004,9714009.932855,83.022887532520258,9714009.932855,83.022887532520258,0.05035272690664274,0.4891982235485004,0,60.609021795694339,338.69078822461529,0.16666101407495337,HBM,No,No
4,infeed,"%infeed.26 = (((u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, /*index=5*/u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=10*/f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=15*/u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, /*index=20*/u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=25*/f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=30*/u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, /*index=35*/u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)})), token[]) infeed(token[] %after-all.28), infeed_config=""\032_\n\007\010\200\010\030\003 \003\020\001\030\200\270\002\""N\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\""\007\010\r\020\300\361\333\007\""\007\0109\020\300\361\333\007\""\007\010%\020\300\361\333\007\""\007\010\024\020\300\361\333\007\""\007\010\000\020\300\361\333\007\""\007\010,\020\300\361\333\007\""\007\010\017\020\300\361\333\007\""\007\010;\020\300\361\333\007\""\007\010\'\020\300\361\333\007\""\007\010\026\020\300\361\333\007\""\007\010\002\020\300\361\333\007\""\007\010.\020\300\361\333\007\""\007\010\035\020\300\361\333\007\""\007\010\t\020\300\361\333\007\""\007\0105\020\300\361\333\007\""\007\010!\020\300\361\333\007\""\007\010\020\020\300\361\333\007\""\007\010<\020\300\361\333\007\""\007\010(\020\300\361\333\007\""\007\010\037\020\300\361\333\007\""\007\010\013\020\300\361\333\007\""\007\0107\020\300\361\333\007\""\007\010#\020\300\361\333\007\""\007\010\022\020\300\361\333\007\""\007\010>\020\300\361\333\007\""\007\010*\020\300\361\333\007\""\007\010\031\020\300\361\333\007\""\007\010\005\020\300\361\333\007\""\007\0101\020\300\361\333\007\""\007\010\014\020\300\361\333\007\""\007\0108\020\300\361\333\007\""\007\010$\020\300\361\333\007\""\007\010\033\020\300\361\333\007\""\007\010\007\020\300\361\333\007\""\007\0103\020\300\361\333\007\""\007\010\016\020\300\361\333\007\""\007\010:\020\300\361\333\007\""\007\010&\020\300\361\333\007\""\007\010\025\020\300\361\333\007\""\007\010\001\020\300\361\333\007\""\007\010-\020\300\361\333\007\""\007\010\034\020\300\361\333\007\""\007\010\010\020\300\361\333\007\""\007\0104\020\300\361\333\007\""\007\010 \020\300\361\333\007\""\007\010\027\020\300\361\333\007\""\007\010\003\020\300\361\333\007\""\007\010/\020\300\361\333\007\""\007\010\036\020\300\361\333\007\""\007\010\n\020\300\361\333\007\""\007\0106\020\300\361\333\007\""\007\010\""\020\300\361\333\007\""\007\010\021\020\300\361\333\007\""\007\010=\020\300\361\333\007\""\007\010)\020\300\361\333\007\""\007\010\030\020\300\361\333\007\""\007\010\004\020\300\361\333\007\""\007\0100\020\300\361\333\007\""\007\010\023\020\300\361\333\007\""\007\010?\020\300\361\333\007\""\007\010+\020\300\361\333\007\""\007\010\032\020\300\361\333\007\""\007\010\006\020\300\361\333\007\""\007\0102\020\300\361\333\007"", sharding={{maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}}",RecvTPUEmbeddingDeduplicationData_cluster_TPU_REPLICATED_CORE_0:_RecvTPUEmbeddingDeduplicationData,155954,6046319.891427,38.769892990413844,6046319.891427,38.769892990413844,0.031341196517980743,0.52053942006648113,0,0,0.95933456274489326,0,HBM,No,No
5,gather fusion,"%fusion.1202 = bf16[1664,128]{1,0:T(8,128)(2,1)} fusion(f32[19656,128]{1,0:T(8,128)} %get-tuple-element.3546, s32[2048]{0} %fusion.1201), kind=kCustom, calls=%fused_computation.clone",while/Gather:ResourceGather,155954,3955217.688572,25.361437914846682,3955217.688572,25.361437914846682,0.020501934577542232,0.54104135464402336,0,0,40.912414340532429,0,HBM,No,No
6,unknown,,,39004,3240408.405713,83.07887410811712,3240408.405713,83.07887410811712,0.016796709149637618,0.557838063793661,0,0,0,0,Unknown,No,No
7,convolution fusion,"%fusion.1291 = f32[128,27,128]{2,1,0:T(8,128)} fusion(f32[128,27,128]{2,1,0:T(8,128)} %fusion.1288, bf16[128,27,27]{2,1,0:T(8,128)(2,1)} %copy.153, bf16[128,27,128]{2,0,1:T(8,128)(2,1)} %fusion.1271), kind=kOutput, calls=%fused_computation.15.clone",while/training/gradients/while/MatMul_grad/MatMul:BatchMatMulV2,155972,2871349.300002,18.409389505821558,2871349.300002,18.409389505821558,0.01488368533241633,0.57272174912607732,0,1321.6212298787043,309.993283999819,3.9705882352941178,HBM,No,No
8,loop fusion,"%fusion.1390 = f32[857,1024]{1,0:T(8,128)} fusion(f32[857,1024]{1,0:T(8,128)} %get-tuple-element.3567, f32[857,1024]{1,0:T(8,128)} %get-tuple-element.2794, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.7.clone",while/training/train/update_top_mlp_layer_0/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,2861617.515713,29.349923238082052,2861617.515713,29.349923238082052,0.0148332404718484,0.58755498959792574,0,59.800360831018452,336.92248209792717,0.16530041469765647,HBM,No,No
9,convolution fusion,"%fusion.1284 = (f32[1024]{0:T(1024)}, bf16[128,1024]{1,0:T(8,128)(2,1)}) fusion(bf16[128,1024]{1,0:T(8,128)(2,1)} %get-tuple-element.2744, f32[1024,1024]{1,0:T(8,128)} %get-tuple-element.3569, f32[128,1024]{1,0:T(8,128)} %fusion.1275), kind=kOutput, calls=%fused_computation.770.clone",while/training/gradients/while/top_mlp_layer_1/MatMul_grad/MatMul:MatMul,155964,2755782.155713,17.66934777072273,2755782.155713,17.66934777072273,0.014284641179076215,0.601839630777002,0,15221.768425750939,276.55956861824797,51.259758001561281,HBM,No,No
10,unknown,,,78008,2711758.497142,34.7625691870321,2711758.497142,34.7625691870321,0.014056443835983182,0.61589607461298512,0,0,0,0,Unknown,No,No
11,loop fusion,"%fusion.1392 = f32[1024,1024]{1,0:T(8,128)} fusion(f32[1024,1024]{1,0:T(8,128)} %get-tuple-element.3569, f32[1024,1024]{1,0:T(8,128)} %get-tuple-element.2796, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.6.clone",while/training/train/update_top_mlp_layer_1/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,78008,2698775.385713,34.596136110565581,2698775.385713,34.596136110565581,0.013989145668830616,0.62988522028181571,0,60.618098891093638,338.75758948318781,0.16665310440231101,HBM,No,No
12,convolution fusion,"%fusion.1288 = f32[128,27,128]{2,1,0:T(8,128)} fusion(bf16[128,27,27]{2,1,0:T(8,128)(2,1)} %copy.153, bf16[128,27,128]{2,0,1:T(8,128)(2,1)} %fusion.1271), kind=kOutput, calls=%fused_computation.8.clone",while/training/gradients/while/MatMul_grad/MatMul_1:BatchMatMulV2,155972,2281775.25285,14.629390229336034,2281775.25285,14.629390229336034,0.011827618765397317,0.641712839047213,0,1632.8686039215845,256.58363407558664,5.9268292682926829,HBM,No,No
13,convolution,"%convolution.372 = f32[128,857]{0,1:T(8,128)} convolution(bf16[128,1024]{1,0:T(8,128)(2,1)} %get-tuple-element.2745, f32[857,1024]{1,0:T(8,128)} %get-tuple-element.3567), dim_labels=bf_oi->bf",while/training/gradients/while/top_mlp_layer_0/MatMul_grad/MatMul:MatMul,155966,2171774.895713,13.924668810593335,2171774.895713,13.924668810593335,0.011257430142898695,0.6529702691901117,0,16133.770293271866,283.8147478349868,52.942084942084939,HBM,No,No
14,convolution fusion,"%fusion.1276 = f32[128,1024]{1,0:T(8,128)} fusion(f32[128,1024]{1,0:T(8,128)} %fusion.1275, f32[1024,1024]{1,0:T(8,128)} %get-tuple-element.3569, f32[1024]{0:T(1024)} %get-tuple-element.3568), kind=kOutput, calls=%fused_computation.21.clone",while/top_mlp_layer_1/MatMul:MatMul,136468,2156669.815716,15.803483715713572,2156669.815716,15.803483715713572,0.011179132717504937,0.66414940190761662,0,17002.4283780437,309.21202471187115,51.209992193598751,HBM,No,No
15,convolution fusion,"%fusion.1275 = f32[128,1024]{1,0:T(8,128)} fusion(f32[857,1024]{1,0:T(8,128)} %get-tuple-element.3567, bf16[128,729]{0,1:T(8,128)(2,1)} %reshape.406, bf16[128,128]{0,1:T(8,128)(2,1)} %copy.152, f32[1024]{0:T(1024)} %get-tuple-element.3566), kind=kOutput, calls=%fused_computation.23.clone",while/top_mlp_layer_0/MatMul:MatMul,155960,2119222.165709,13.588241637015901,2119222.165709,13.588241637015901,0.010985022220693471,0.67513442412831,0,16560.586278285995,293.92971833867063,52.472570439350527,HBM,No,No
16,convolution,"%convolution.405 = f32[1024,1024]{1,0:T(8,128)} convolution(f32[128,1024]{1,0:T(8,128)} %fusion.1275, bf16[128,1024]{1,0:T(8,128)(2,1)} %get-tuple-element.2744), dim_labels=fb_io->bf",while/training/gradients/while/top_mlp_layer_1/MatMul_grad/MatMul_1:MatMul,116982,2051944.3,17.540684036860373,2051944.3,17.540684036860373,0.010636286320450118,0.68577071044876015,0,15303.591093477537,264.45216533317108,53.89473684210526,HBM,No,No
17,convolution fusion,"%fusion.1273 = bf16[128,27,27]{2,1,0:T(8,128)(2,1)} fusion(pred[128,27,27]{2,1,0:T(8,128)(4,1)} %get-tuple-element.3578, bf16[128,27,128]{2,0,1:T(8,128)(2,1)} %fusion.1271), kind=kOutput, calls=%fused_computation.14.clone",while/MatMul:BatchMatMulV2,155959,1834263.991424,11.761193592059451,1834263.991424,11.761193592059451,0.00950793693575275,0.695278647384513,0,2039.0093753911892,194.60765962621579,9.75796875,HBM,No,No
18,loop fusion,"%fusion.1394 = f32[1024,512]{1,0:T(8,128)} fusion(f32[1024,512]{1,0:T(8,128)} %get-tuple-element.3571, f32[1024,512]{1,0:T(8,128)} %get-tuple-element.2798, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.16.clone",while/training/train/update_top_mlp_layer_2/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,1724338.495714,17.685523032964102,1724338.495714,17.685523032964102,0.0089381363586664379,0.70421678374317942,0,59.290075732878009,331.36303989194147,0.16663954434499592,HBM,No,No
19,unknown,,,58514,1722826.038569,29.442971572085316,1722826.038569,29.442971572085316,0.0089302965127010143,0.71314708025588047,0,0,0,0,Unknown,No,No
20,convolution fusion,"%fusion.1283 = (f32[1024]{0:T(1024)}, bf16[128,1024]{1,0:T(8,128)(2,1)}) fusion(bf16[128,512]{1,0:T(8,128)(2,1)} %get-tuple-element.2743, f32[1024,512]{1,0:T(8,128)} %get-tuple-element.3571, f32[128,1024]{1,0:T(8,128)} %fusion.1276), kind=kOutput, calls=%fused_computation.771.clone",while/training/gradients/while/top_mlp_layer_2/MatMul_grad/MatMul:MatMul,155964,1657810.661426,10.629444368097767,1657810.661426,10.629444368097767,0.0085932882583712074,0.72174036851425172,0,12676.202756599318,264.49471744610275,44.634667571234736,HBM,No,No
21,convolution fusion,"%fusion.1378 = f32[857,1024]{1,0:T(8,128)} fusion(bf16[128,1024]{1,0:T(8,128)(2,1)} %get-tuple-element.2745, bf16[128,729]{0,1:T(8,128)(2,1)} %reshape.406, bf16[128,128]{0,1:T(8,128)(2,1)} %copy.152), kind=kOutput, calls=%fused_computation.27.clone",while/training/gradients/while/top_mlp_layer_0/MatMul_grad/MatMul_1:MatMul,116982,1519429.235712,12.988572906190695,1519429.235712,12.988572906190695,0.0078759859098980044,0.72961635442414974,0,17304.98844048295,288.40987704170766,55.880632637474541,HBM,No,No
22,convolution,"%convolution.406 = f32[1024,512]{1,0:T(8,128)} convolution(f32[128,1024]{1,0:T(8,128)} %fusion.1276, bf16[128,512]{1,0:T(8,128)(2,1)} %get-tuple-element.2743), dim_labels=fb_io->bf",while/training/gradients/while/top_mlp_layer_2/MatMul_grad/MatMul_1:MatMul,155969,1513823.227142,9.7059237870474266,1513823.227142,9.7059237870474266,0.0078469270742047466,0.73746328149835449,0,13828.434154728664,264.1146395468183,48.761904761904759,HBM,No,No
23,data formatting,"%copy.153 = bf16[128,27,27]{2,1,0:T(8,128)(2,1)} copy(bf16[128,27,27]{0,2,1:T(8,128)(2,1)} %reshape.407)",while/training/gradients/while/Select_grad/Select_1:,155966,1483277.311429,9.5102606428901169,1483277.311429,9.5102606428901169,0.007688591828241294,0.74515187332659583,0,0,124.34529365090263,0,HBM,No,No
24,concatenate,"%concatenate.218 = bf16[128,14,128]{2,0,1:T(8,128)(2,1)} concatenate(f32[128,1,128]{2,0,1:T(8,128)} %bitcast.90, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1210, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1215, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1220, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1225, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1230, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1235, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1240, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1245, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1250, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1255, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1260, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1265, bf16[128,1,128]{2,0,1:T(8,128)(2,1)} %fusion.1270), dimensions={1}",while/concat:ConcatV2,155958,1474392.32286,9.4537780867925978,1474392.32286,9.4537780867925978,0.0076425363469234961,0.75279440967351929,0,0,93.6144002423959,0,HBM,No,No
25,convolution fusion,"%fusion.1277 = f32[128,512]{1,0:T(8,128)} fusion(f32[128,1024]{1,0:T(8,128)} %fusion.1276, f32[1024,512]{1,0:T(8,128)} %get-tuple-element.3571, f32[512]{0:T(512)} %get-tuple-element.3570), kind=kOutput, calls=%fused_computation.32.clone",while/top_mlp_layer_2/MatMul:MatMul,155964,1425918.031429,9.1426100345528454,1425918.031429,9.1426100345528454,0.0073912690767344094,0.76018567875025367,0,14694.797163200985,293.94825038585867,46.557842441447832,HBM,No,No
26,data formatting,"%copy.151 = bf16[128,27,27]{0,2,1:T(8,128)(2,1)} copy(bf16[128,27,27]{2,1,0:T(8,128)(2,1)} %fusion.1273)",while/Select:,155960,1338772.304286,8.5840747902410879,1338772.304286,8.5840747902410879,0.0069395477968259983,0.76712522654707971,0,0,137.7616320026938,0,HBM,No,No
27,outfeed,"%outfeed.4 = token[] outfeed(((f32[816,128]{1,0:T(8,128)}, f32[952,128]{1,0:T(8,128)}), (f32[]{:T(256)})) %tuple.355, token[] %after-all.31), outfeed_shape=((f32[816,128]{1,0:T(8,128)}, f32[952,128]{1,0:T(8,128)}), (f32[]{:T(256)})), outfeed_config=""\022\270\001\n\033\010\210\001\022\002\006\007\030\200\340\035\""\016\n\006\010\001\020\001\030\002\022\000\022\002\030\001\022\230\001\010\200\370\273\005\020\005\030\200\370\262\006 \200\010(\t0\001:\200\001\n\002\020\005\n\004\010\001\020\004\n\004\010\001\020\001\n\004\010\001\020\002\n\002\010\001\n\004\010\001\020\013\n\002\020\006\n\004\010\001\020\010\n\004\010\001\020\006\n\002\020\010\n\002\020\004\n\004\010\001\020\007\n\002\020\001\n\002\020\t\n\004\010\001\020\003\n\002\020\002\n\004\010\001\020\014\n\002\020\014\n\004\010\001\020\005\n\004\010\001\020\r\n\002\020\007\n\002\020\r\n\002\020\003\n\004\010\001\020\n\n\000\n\004\010\001\020\t@\005\""\007\0100\020\300\361\333\007\""\007\010\001\020\300\361\333\007\""\007\010\025\020\300\361\333\007\""\007\010)\020\300\361\333\007\""\007\010=\020\300\361\333\007\""\007\010\016\020\300\361\333\007\""\007\010\""\020\300\361\333\007\""\007\0106\020\300\361\333\007\""\007\010\007\020\300\361\333\007\""\007\010\033\020\300\361\333\007\""\007\010/\020\300\361\333\007\""\007\010\014\020\300\361\333\007\""\007\010 \020\300\361\333\007\""\007\0104\020\300\361\333\007\""\007\010\005\020\300\361\333\007\""\007\010\031\020\300\361\333\007\""\007\010-\020\300\361\333\007\""\007\010\022\020\300\361\333\007\""\007\010&\020\300\361\333\007\""\007\010:\020\300\361\333\007\""\007\010\013\020\300\361\333\007\""\007\010\037\020\300\361\333\007\""\007\0103\020\300\361\333\007\""\007\010\020\020\300\361\333\007\""\007\010$\020\300\361\333\007\""\007\0108\020\300\361\333\007\""\007\010\t\020\300\361\333\007\""\007\010\035\020\300\361\333\007\""\007\0101\020\300\361\333\007\""\007\010\002\020\300\361\333\007\""\007\010\026\020\300\361\333\007\""\007\010*\020\300\361\333\007\""\007\010>\020\300\361\333\007\""\007\010\017\020\300\361\333\007\""\007\010#\020\300\361\333\007\""\007\0107\020\300\361\333\007\""\007\010\000\020\300\361\333\007\""\007\010\024\020\300\361\333\007\""\007\010(\020\300\361\333\007\""\007\010<\020\300\361\333\007\""\007\010\r\020\300\361\333\007\""\007\010!\020\300\361\333\007\""\007\0105\020\300\361\333\007\""\007\010\006\020\300\361\333\007\""\007\010\032\020\300\361\333\007\""\007\010.\020\300\361\333\007\""\007\010\023\020\300\361\333\007\""\007\010\'\020\300\361\333\007\""\007\010;\020\300\361\333\007\""\007\010\004\020\300\361\333\007\""\007\010\030\020\300\361\333\007\""\007\010,\020\300\361\333\007\""\007\010\021\020\300\361\333\007\""\007\010%\020\300\361\333\007\""\007\0109\020\300\361\333\007\""\007\010\n\020\300\361\333\007\""\007\010\036\020\300\361\333\007\""\007\0102\020\300\361\333\007\""\007\010\003\020\300\361\333\007\""\007\010\027\020\300\361\333\007\""\007\010+\020\300\361\333\007\""\007\010?\020\300\361\333\007\""\007\010\010\020\300\361\333\007\""\007\010\034\020\300\361\333\007"", sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,1327981.307141,9.7299412908546046,1327981.307141,9.7299412908546046,0.0068836124893630318,0.77400883903644269,0,0,86.74274024735,0,HBM,No,No
28,data formatting,"%copy.156 = f32[128,14,128]{0,2,1:T(8,128)} copy(f32[128,14,128]{2,1,0:T(8,128)} %slice.807)",while/training/gradients/while/concat_1_grad/Slice:Slice,155972,1263372.687143,8.09999671186495,1263372.687143,8.09999671186495,0.006548712667244134,0.78055755170368679,0,0,226.05622602378136,0,HBM,No,No
29,infeed,"%infeed.28 = ((f32[816,128]{1,0:T(8,128)}, f32[952,128]{1,0:T(8,128)}), token[]) infeed(token[] %after-all.30), infeed_config=""\n(\n\033\010\210\001\022\002\006\007\030\200\340\035\""\016\n\006\010\001\020\001\030\002\022\000\022\002\030\001\022\t\010\200\370\304\004\030\001 \001\""\007\010=\020\300\361\333\007\""\007\010\t\020\300\361\333\007\""\007\0104\020\300\361\333\007\""\007\010\000\020\300\361\333\007\""\007\010\034\020\300\361\333\007\""\007\010/\020\300\361\333\007\""\007\010;\020\300\361\333\007\""\007\010\027\020\300\361\333\007\""\007\010&\020\300\361\333\007\""\007\0102\020\300\361\333\007\""\007\010\016\020\300\361\333\007\""\007\010\032\020\300\361\333\007\""\007\010-\020\300\361\333\007\""\007\0109\020\300\361\333\007\""\007\010\025\020\300\361\333\007\""\007\010$\020\300\361\333\007\""\007\0100\020\300\361\333\007\""\007\010\014\020\300\361\333\007\""\007\010\030\020\300\361\333\007\""\007\010+\020\300\361\333\007\""\007\010\007\020\300\361\333\007\""\007\010\023\020\300\361\333\007\""\007\010\""\020\300\361\333\007\""\007\010>\020\300\361\333\007\""\007\010\n\020\300\361\333\007\""\007\010)\020\300\361\333\007\""\007\010\005\020\300\361\333\007\""\007\010\021\020\300\361\333\007\""\007\010 \020\300\361\333\007\""\007\010<\020\300\361\333\007\""\007\010\010\020\300\361\333\007\""\007\0107\020\300\361\333\007\""\007\010\003\020\300\361\333\007\""\007\010\037\020\300\361\333\007\""\007\010.\020\300\361\333\007\""\007\010:\020\300\361\333\007\""\007\010\026\020\300\361\333\007\""\007\0105\020\300\361\333\007\""\007\010\001\020\300\361\333\007\""\007\010\035\020\300\361\333\007\""\007\010,\020\300\361\333\007\""\007\0108\020\300\361\333\007\""\007\010\024\020\300\361\333\007\""\007\010\'\020\300\361\333\007\""\007\0103\020\300\361\333\007\""\007\010\017\020\300\361\333\007\""\007\010\033\020\300\361\333\007\""\007\010*\020\300\361\333\007\""\007\010\006\020\300\361\333\007\""\007\010\022\020\300\361\333\007\""\007\010%\020\300\361\333\007\""\007\0101\020\300\361\333\007\""\007\010\r\020\300\361\333\007\""\007\010\031\020\300\361\333\007\""\007\010(\020\300\361\333\007\""\007\010\004\020\300\361\333\007\""\007\010\020\020\300\361\333\007\""\007\010#\020\300\361\333\007\""\007\010?\020\300\361\333\007\""\007\010\013\020\300\361\333\007\""\007\0106\020\300\361\333\007\""\007\010\002\020\300\361\333\007\""\007\010\036\020\300\361\333\007\""\007\010!\020\300\361\333\007"", sharding={{maximal device=0}, {maximal device=0}, {maximal device=0}}",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155956,1263309.968571,8.10042555958732,1263309.968571,8.10042555958732,0.0065483875645162472,0.787105939268203,0,0,104.07454392323498,0,HBM,No,No
30,slice,"%slice.834 = f32[128,13,128]{2,1,0:T(8,128)} slice(f32[128,27,128]{2,1,0:T(8,128)} %fusion.1291), slice={[0:128], [14:27], [0:128]}",while/training/gradients/while/concat_1_grad/Slice_1:Slice,155972,1140784.701427,7.3140352205972876,1140784.701427,7.3140352205972876,0.0059132758693141779,0.79301921513751727,0,0,267.03795389011162,0,HBM,No,No
31,concatenate,"%concatenate.220 = f32[136,896]{0,1:T(8,128)} concatenate(f32[136,128]{0,1:T(8,128)} %fusion.1334, f32[136,128]{0,1:T(8,128)} %fusion.1340, f32[136,128]{0,1:T(8,128)} %fusion.1346, f32[136,128]{0,1:T(8,128)} %fusion.1352, f32[136,128]{0,1:T(8,128)} %fusion.1358, f32[136,128]{0,1:T(8,128)} %fusion.1364, f32[136,128]{0,1:T(8,128)} %fusion.1370), dimensions={1}, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,1131717.229999,8.291940667030568,1131717.229999,8.291940667030568,0.0058662744851583262,0.79888548962267558,0,0,206.10185764895883,0,HBM,No,No
32,data formatting,"%copy.159 = f32[128,1792]{1,0:T(8,128)} copy(f32[128,1792]{0,1:T(8,128)} %bitcast.110)",while/training/gradients/while/Reshape_13_grad/Reshape:Reshape,136484,1084245.934287,7.9441248372483217,1084245.934287,7.9441248372483217,0.0056202062594293981,0.804505695882105,0,0,215.12556889550382,0,HBM,No,No
33,concatenate,"%concatenate.219 = f32[136,768]{0,1:T(8,128)} concatenate(f32[136,128]{0,1:T(8,128)} %fusion.1298, f32[136,128]{0,1:T(8,128)} %fusion.1304, f32[136,128]{0,1:T(8,128)} %fusion.1310, f32[136,128]{0,1:T(8,128)} %fusion.1316, f32[136,128]{0,1:T(8,128)} %fusion.1322, f32[136,128]{0,1:T(8,128)} %fusion.1328), dimensions={1}, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,1058656.742858,7.7566362566894291,1058656.742858,7.7566362566894291,0.0054875642736076334,0.8099932601557126,0,0,188.85038585225416,0,HBM,No,No
34,unknown,,,58514,1033800.131428,17.667568982260658,1033800.131428,17.667568982260658,0.0053587196280070418,0.81535197978371965,0,0,0,0,Unknown,No,No
35,slice,"%slice.807 = f32[128,14,128]{2,1,0:T(8,128)} slice(f32[128,27,128]{2,1,0:T(8,128)} %fusion.1291), slice={[0:128], [0:14], [0:128]}",while/training/gradients/while/concat_1_grad/Slice:Slice,155972,939059.645715,6.0206937508975971,939059.645715,6.0206937508975971,0.0048676307947565578,0.82021961057847625,0,0,324.40198435559495,0,HBM,No,No
36,data formatting,"%copy.149 = bf16[128,13,128]{2,0,1:T(8,128)(2,1)} copy(bf16[128,13,128]{2,1,0:T(8,128)(2,1)} %reshape.403)",,155954,851850.904288,5.4621933665568045,851850.904288,5.4621933665568045,0.0044155828792923459,0.82463519345776859,0,0,162.02461286676788,0,HBM,No,No
37,data formatting,"%reshape.410 = f32[1664,128]{1,0:T(8,128)} reshape(f32[128,13,128]{2,1,0:T(8,128)} %slice.834)",while/training/gradients/while/Gather_grad/Reshape:Reshape,155972,841641.535713,5.3961065813928144,841641.535713,5.3961065813928144,0.0043626624528876395,0.82899785591065622,0,0,328.01789670779993,0,HBM,No,No
38,loop fusion,"%fusion.1271 = bf16[128,27,128]{2,0,1:T(8,128)(2,1)} fusion(bf16[128,13,128]{2,0,1:T(8,128)(2,1)} %copy.149, bf16[128,14,128]{2,0,1:T(8,128)(2,1)} %concatenate.218), kind=kLoop, calls=%fused_computation.17.clone",while/concat_1:ConcatV2,155958,802601.678572,5.1462680886648968,802601.678572,5.1462680886648968,0.0041602987247585941,0.83315815463541487,0,85.9589886065893,320.22218631984163,0.25,HBM,No,No
39,data formatting,"%copy.158 = f32[136,896]{1,0:T(8,128)} copy(f32[136,896]{0,1:T(8,128)} %concatenate.220)",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,799637.727142,5.8588385975059349,799637.727142,5.8588385975059349,0.0041449350347942089,0.837303089670209,0,0,223.32773643204169,0,HBM,No,No
40,data formatting,"%copy.157 = f32[136,768]{1,0:T(8,128)} copy(f32[136,768]{0,1:T(8,128)} %concatenate.219)",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,773623.972858,5.6682393017350012,773623.972858,5.6682393017350012,0.0040100923205770344,0.84131318199078609,0,0,197.86055887652171,0,HBM,No,No
41,loop fusion,"%fusion.1297 = (f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, /*index=5*/f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, /*index=10*/f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}, f32[128,128]{0,1:T(8,128)}) fusion(f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kLoop, calls=%fused_computation.767.clone, sharding={maximal device=0}",while/training/gradients/while/concat_grad/Slice_13:Slice,136484,713298.318571,5.2262413071935176,713298.318571,5.2262413071935176,0.0036973933201874913,0.84501057531097357,0,0,303.64347323695148,0,HBM,No,No
42,unknown,,,38996,688491.888571,17.655448983767563,688491.888571,17.655448983767563,0.0035688087908373506,0.84857938410181089,0,0,0,0,Unknown,No,No
43,data formatting,"%copy.160 = f32[128,857]{1,0:T(8,128)} copy(f32[128,857]{0,1:T(8,128)} %convolution.372)",while/training/gradients/while/top_mlp_layer_0/MatMul_grad/MatMul:MatMul,155966,645880.980001,4.1411652539720194,645880.980001,4.1411652539720194,0.0033479344601232853,0.85192731856193415,0,0,202.65634114156833,0,HBM,No,No
44,convolution fusion,"%fusion.1380 = f32[512,256]{1,0:T(8,128)} fusion(f32[128,512]{1,0:T(8,128)} %fusion.1277, pred[128,256]{1,0:T(8,128)(4,1)} %get-tuple-element.2742, f32[128]{0:T(256)} %bitcast.107, f32[256]{0:T(256)} %reduce.37), kind=kOutput, calls=%fused_computation.56.clone",while/training/gradients/while/top_mlp_layer_3/MatMul_grad/MatMul_1:MatMul,155964,639347.914284,4.0993300651688855,639347.914284,4.0993300651688855,0.00331407020878063,0.85524138877071476,0,8201.3322824774568,186.57848711721212,40.937655860349125,HBM,No,No
45,convolution fusion,"%fusion.1278 = (f32[128]{0:T(256)}, f32[128,256]{1,0:T(8,128)}) fusion(f32[256]{0:T(256)} %reduce.37, f32[256]{0:T(256)} %get-tuple-element.3572, f32[128,512]{1,0:T(8,128)} %fusion.1277, f32[512,256]{1,0:T(8,128)} %get-tuple-element.3573), kind=kOutput, calls=%fused_computation.58.clone",while/top_mlp_layer_3/MatMul:MatMul,155964,637638.414284,4.0883692024056835,637638.414284,4.0883692024056835,0.0033052089880034339,0.85854659775871822,0,8239.31849896991,209.70542727395815,36.591629588431587,HBM,No,No
46,convolution fusion,"%fusion.1282 = (f32[512]{0:T(512)}, bf16[128,512]{1,0:T(8,128)(2,1)}) fusion(f32[512,256]{1,0:T(8,128)} %get-tuple-element.3573, pred[128,256]{1,0:T(8,128)(4,1)} %get-tuple-element.2742, f32[128]{0:T(256)} %bitcast.107, f32[256]{0:T(256)} %reduce.37, f32[128,512]{1,0:T(8,128)} %fusion.1277), kind=kOutput, calls=%fused_computation.772.clone",while/training/gradients/while/top_mlp_layer_3/MatMul_grad/MatMul:MatMul,155964,614846.171427,3.9422313574094021,614846.171427,3.9422313574094021,0.0031870650301424495,0.86173366278886065,0,8594.5234889169351,225.46227816255779,35.501609442060087,HBM,No,No
47,convolution fusion,"%fusion.1204 = f32[128,256]{1,0:T(8,128)} fusion(f32[128,512]{1,0:T(8,128)} %fusion.1203, f32[512,256]{1,0:T(8,128)} %get-tuple-element.3563, f32[256]{0:T(256)} %get-tuple-element.3562), kind=kOutput, calls=%fused_computation.54.clone",while/bottom_mlp_layer_1/MatMul:MatMul,155954,596688.599996,3.8260551187914382,596688.599996,3.8260551187914382,0.0030929449662478589,0.86482660775510856,0,8787.1102104299425,223.58430165051814,36.602006688963208,HBM,No,No
48,unknown,,,38996,504178.080002,12.928969125089752,504178.080002,12.928969125089752,0.0026134151962097984,0.86744002295131839,0,0,0,0,Unknown,No,No
49,convolution fusion,"%fusion.1376 = (f32[512]{0:T(512)}, bf16[128,512]{1,0:T(8,128)(2,1)}) fusion(bf16[128,256]{1,0:T(8,128)(2,1)} %get-tuple-element.2763, f32[512,256]{1,0:T(8,128)} %get-tuple-element.3563, f32[128,512]{1,0:T(8,128)} %fusion.1203), kind=kOutput, calls=%fused_computation.768.clone",while/training/gradients/while/bottom_mlp_layer_1/MatMul_grad/MatMul:MatMul,116982,501590.791431,4.2877604369133708,501590.791431,4.2877604369133708,0.0026000039442402472,0.87004002689555859,0,7886.6495685899745,213.96593999963511,34.32796257796258,HBM,No,No
50,data formatting,"%reshape.405 = f32[136,896]{1,0:T(8,128)} reshape(f32[952,128]{1,0:T(8,128)} %get-tuple-element.2696), sharding={maximal device=0}",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,487726.014284,3.1272907724130854,487726.014284,3.1272907724130854,0.0025281356486414213,0.8725681625442,0,0,290.3145295033936,0,HBM,No,No
51,data formatting,"%reshape.403 = bf16[128,13,128]{2,1,0:T(8,128)(2,1)} reshape(bf16[1664,128]{1,0:T(8,128)(2,1)} %fusion.1202)",,155954,460029.939996,2.949779678597535,460029.939996,2.949779678597535,0.0023845726015939823,0.874952735145794,0,0,300.02571786668807,0,HBM,No,No
52,infeed,"%infeed.31 = (((u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, /*index=5*/u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=10*/f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=15*/u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, /*index=20*/u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=25*/f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, /*index=30*/u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, /*index=35*/u32[128]{0:T(256)}, u32[128]{0:T(256)}, f32[128]{0:T(256)}, u32[128]{0:T(256)})), token[]) infeed(token[] %get-tuple-element.3704), infeed_config=""\032_\n\007\010\200\010\030\003 \003\020\001\030\200\270\002\""N\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\200\010\""\007\010\030\020\300\361\333\007\""\007\010;\020\300\361\333\007\""\007\010\017\020\300\361\333\007\""\007\010\023\020\300\361\333\007\""\007\010\""\020\300\361\333\007\""\007\0106\020\300\361\333\007\""\007\010\032\020\300\361\333\007\""\007\010)\020\300\361\333\007\""\007\010=\020\300\361\333\007\""\007\010\001\020\300\361\333\007\""\007\010\025\020\300\361\333\007\""\007\010$\020\300\361\333\007\""\007\010\010\020\300\361\333\007\""\007\010\034\020\300\361\333\007\""\007\010+\020\300\361\333\007\""\007\010?\020\300\361\333\007\""\007\010\003\020\300\361\333\007\""\007\010\027\020\300\361\333\007\""\007\010&\020\300\361\333\007\""\007\010\n\020\300\361\333\007\""\007\010\036\020\300\361\333\007\""\007\010-\020\300\361\333\007\""\007\0101\020\300\361\333\007\""\007\010\005\020\300\361\333\007\""\007\0108\020\300\361\333\007\""\007\010\014\020\300\361\333\007\""\007\010\020\020\300\361\333\007\""\007\010/\020\300\361\333\007\""\007\0103\020\300\361\333\007\""\007\010\007\020\300\361\333\007\""\007\010:\020\300\361\333\007\""\007\010\016\020\300\361\333\007\""\007\010\022\020\300\361\333\007\""\007\010!\020\300\361\333\007\""\007\0105\020\300\361\333\007\""\007\010\031\020\300\361\333\007\""\007\010(\020\300\361\333\007\""\007\010<\020\300\361\333\007\""\007\010\000\020\300\361\333\007\""\007\010\024\020\300\361\333\007\""\007\010#\020\300\361\333\007\""\007\0107\020\300\361\333\007\""\007\010\033\020\300\361\333\007\""\007\010*\020\300\361\333\007\""\007\010>\020\300\361\333\007\""\007\010\002\020\300\361\333\007\""\007\010\026\020\300\361\333\007\""\007\010%\020\300\361\333\007\""\007\010\t\020\300\361\333\007\""\007\010\035\020\300\361\333\007\""\007\010,\020\300\361\333\007\""\007\0100\020\300\361\333\007\""\007\010\004\020\300\361\333\007\""\007\010\'\020\300\361\333\007\""\007\010\013\020\300\361\333\007\""\007\010\037\020\300\361\333\007\""\007\010.\020\300\361\333\007\""\007\0102\020\300\361\333\007\""\007\010\006\020\300\361\333\007\""\007\0109\020\300\361\333\007\""\007\010\r\020\300\361\333\007\""\007\010\021\020\300\361\333\007\""\007\010 \020\300\361\333\007\""\007\0104\020\300\361\333\007""",RecvTPUEmbeddingDeduplicationData_cluster__0:_RecvTPUEmbeddingDeduplicationData,10972,457238.890004,41.673249180094786,457238.890004,41.673249180094786,0.0023701051490176129,0.87732284029481156,0,0,0.892498163003578,0,HBM,No,No
53,data formatting,"%reshape.404 = f32[136,768]{1,0:T(8,128)} reshape(f32[816,128]{1,0:T(8,128)} %get-tuple-element.2695), sharding={maximal device=0}",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155957,447598.9,2.8700148117750408,447598.9,2.8700148117750408,0.0023201361056040949,0.87964297640041567,0,0,271.14781393815315,0,HBM,No,No
54,loop fusion,"%fusion.1396 = f32[512,256]{1,0:T(8,128)} fusion(f32[512,256]{1,0:T(8,128)} %get-tuple-element.3573, f32[512,256]{1,0:T(8,128)} %get-tuple-element.2800, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.24.clone",while/training/train/update_top_mlp_layer_3/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,444447.987142,4.5584408937641028,444447.987142,4.5584408937641028,0.0023038032980671279,0.88194677969848279,0,57.507381604664467,321.556746806343,0.16655823031880287,HBM,No,No
55,loop fusion,"%fusion.1386 = f32[512,256]{1,0:T(8,128)} fusion(f32[512,256]{1,0:T(8,128)} %get-tuple-element.3563, f32[512,256]{1,0:T(8,128)} %get-tuple-element.2790, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.25.clone",while/training/train/update_bottom_mlp_layer_1/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,437688.709999,4.489114974348718,437688.709999,4.489114974348718,0.0022687664761552361,0.884215546174638,0,58.395474720054793,326.52258467058795,0.16655823031880287,HBM,No,No
56,convolution,"%convolution.402 = f32[512,256]{1,0:T(8,128)} convolution(f32[128,512]{1,0:T(8,128)} %fusion.1203, bf16[128,256]{1,0:T(8,128)(2,1)} %get-tuple-element.2763), dim_labels=fb_io->bf",while/training/gradients/while/bottom_mlp_layer_1/MatMul_grad/MatMul_1:MatMul,116982,412243.225712,3.5239885256877126,412243.225712,3.5239885256877126,0.0021368693986180696,0.88635241557325617,0,9521.7199929593389,225.15880101808446,39.384615384615387,HBM,No,No
57,loop fusion,"%fusion.1285 = bf16[128,729]{0,1:T(8,128)(2,1)} fusion(pred[128,729]{0,1:T(8,128)(4,1)} %get-tuple-element.3576, f32[128,857]{0,1:T(8,128)} %convolution.372), kind=kLoop, calls=%fused_computation.28.clone",while/training/gradients/while/Select_grad/Select_1:,155966,380331.508571,2.4385539705512742,380331.508571,2.4385539705512742,0.0019714544989597837,0.88832387007221592,0,38.265300307831751,179.89767331051587,0.19809782608695653,HBM,No,No
58,data formatting,"%reshape.409 = f32[952,128]{1,0:T(8,128)} reshape(f32[136,896]{1,0:T(8,128)} %copy.158), sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,355227.90714,2.6027073293572873,355227.90714,2.6027073293572873,0.0018413295767118567,0.89016519964892782,0,0,348.82829082346564,0,HBM,No,No
59,data formatting,"%reshape.400 = s32[1664]{0:T(1024)} reshape(s32[128,13]{1,0:T(8,128)} %copy.148)",,155954,353661.675713,2.267730713627095,353661.675713,2.267730713627095,0.0018332109908897856,0.89199841063981755,0,0,30.278970235853695,0,HBM,No,No
60,data formatting,"%reshape.408 = f32[816,128]{1,0:T(8,128)} reshape(f32[136,768]{1,0:T(8,128)} %copy.157), sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,336602.282857,2.4662398732232349,336602.282857,2.4662398732232349,0.0017447833533221103,0.89374319399313962,0,0,315.54037003134715,0,HBM,No,No
61,data formatting,"%reshape.407 = bf16[128,27,27]{0,2,1:T(8,128)(2,1)} reshape(bf16[128,729]{0,1:T(8,128)(2,1)} %fusion.1285)",while/training/gradients/while/Select_grad/Select_1:,155966,324141.13,2.0782807150276343,324141.13,2.0782807150276343,0.0016801907668323372,0.895423384759972,0,0,183.55062615070443,0,HBM,No,No
62,convolution fusion,"%fusion.1270 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2730, u32[128]{0:T(256)} %get-tuple-element.2731, u32[128]{0:T(256)} %get-tuple-element.2732), kind=kOutput, calls=%fused_computation.71.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,315324.398571,2.02185459271727,315324.398571,2.02185459271727,0.0016344890974988396,0.89705787385747082,0,2237.5654591064981,48.583342710739579,42.893203883495147,HBM,No,No
63,data formatting,"%reshape.406 = bf16[128,729]{0,1:T(8,128)(2,1)} reshape(bf16[128,27,27]{0,2,1:T(8,128)(2,1)} %copy.151)",while/Reshape_14:Reshape,155960,313734.922856,2.0116371047448065,313734.922856,2.0116371047448065,0.00162625002453563,0.89868412388200647,0,0,189.63148256735337,0,HBM,No,No
64,convolution fusion,"%fusion.1260 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.404, f32[128]{0:T(256)} %get-tuple-element.2724, u32[128]{0:T(256)} %get-tuple-element.2725, u32[128]{0:T(256)} %get-tuple-element.2726), kind=kOutput, calls=%fused_computation.75.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155957,310273.029997,1.9894780612412397,310273.029997,1.9894780612412397,0.0016083052471559292,0.90029242912916241,0,2273.9793356542204,49.373982303670637,42.893203883495147,HBM,No,No
65,unknown,,,19493,308108.785713,15.80612454281024,308108.785713,15.80612454281024,0.0015970868520601062,0.90188951598122247,0,0,0,0,Unknown,No,No
66,convolution fusion,"%fusion.1245 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2715, u32[128]{0:T(256)} %get-tuple-element.2716, u32[128]{0:T(256)} %get-tuple-element.2717), kind=kOutput, calls=%fused_computation.81.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,304040.918573,1.9495051140242885,304040.918573,1.9495051140242885,0.0015760009972371511,0.90346551697845967,0,2320.60535130437,50.386353891884227,42.893203883495147,HBM,No,No
67,convolution fusion,"%fusion.1230 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2706, u32[128]{0:T(256)} %get-tuple-element.2707, u32[128]{0:T(256)} %get-tuple-element.2708), kind=kOutput, calls=%fused_computation.87.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,303929.64572,1.9487916344143934,303929.64572,1.9487916344143934,0.001575424212611856,0.90504094119107148,0,2321.454957065976,50.404801033940849,42.893203883495147,HBM,No,No
68,convolution fusion,"%fusion.1255 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2721, u32[128]{0:T(256)} %get-tuple-element.2722, u32[128]{0:T(256)} %get-tuple-element.2723), kind=kOutput, calls=%fused_computation.77.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,299845.015711,1.9226010574064814,299845.015711,1.9226010574064814,0.0015542514671875159,0.90659519265825894,0,2353.078909725949,51.091438970585251,42.893203883495147,HBM,No,No
69,convolution fusion,"%fusion.1225 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.404, f32[128]{0:T(256)} %get-tuple-element.2703, u32[128]{0:T(256)} %get-tuple-element.2704, u32[128]{0:T(256)} %get-tuple-element.2705), kind=kOutput, calls=%fused_computation.89.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,297459.075714,1.9073024513907588,297459.075714,1.9073024513907588,0.0015418839087935057,0.90813707656705245,0,2371.9531198112732,51.501246966699014,42.893203883495147,HBM,No,No
70,convolution fusion,"%fusion.1215 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2697, u32[128]{0:T(256)} %get-tuple-element.2698, u32[128]{0:T(256)} %get-tuple-element.2699), kind=kOutput, calls=%fused_computation.93.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,297359.482858,1.9066638637197193,297359.482858,1.9066638637197193,0.0015413676676207372,0.90967844423467314,0,2372.7475440658141,51.518495975285113,42.893203883495147,HBM,No,No
71,gather fusion,"%fusion.1399 = bf16[1664,128]{1,0:T(8,128)(2,1)} fusion(bf16[19656,128]{1,0:T(8,128)(2,1)} %get-tuple-element.3685, s32[2048]{0} %fusion.1398), kind=kCustom, calls=%fused_computation.1.clone",Gather:ResourceGather,10990,297289.279996,27.050889899545041,297289.279996,27.050889899545041,0.0015410037699551198,0.91121944800462829,0,0,38.357246659798328,0,HBM,No,No
72,convolution fusion,"%fusion.1240 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.404, f32[128]{0:T(256)} %get-tuple-element.2712, u32[128]{0:T(256)} %get-tuple-element.2713, u32[128]{0:T(256)} %get-tuple-element.2714), kind=kOutput, calls=%fused_computation.83.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,296807.981427,1.9031276460777904,296807.981427,1.9031276460777904,0.0015385089510726061,0.91275795695570094,0,2377.1563664285504,51.614222930189541,42.893203883495147,HBM,No,No
73,convolution fusion,"%fusion.1363 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2727, u32[128]{0:T(256)} %get-tuple-element.2728, u32[128]{0:T(256)} %get-tuple-element.2729, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.99.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,155975,295977.662856,1.8975968126686971,295977.662856,1.8975968126686971,0.001534204981389636,0.91429216193709062,0,2375.4508702302473,49.754382328922645,44.464646464646464,HBM,No,No
74,convolution fusion,"%fusion.1220 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2700, u32[128]{0:T(256)} %get-tuple-element.2701, u32[128]{0:T(256)} %get-tuple-element.2702), kind=kOutput, calls=%fused_computation.91.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,295966.418571,1.8977315595929674,295966.418571,1.8977315595929674,0.0015341466964572776,0.91582630863354786,0,2383.9156687526088,51.760984894161922,42.893203883495147,HBM,No,No
75,convolution fusion,"%fusion.1265 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.405, f32[128]{0:T(256)} %get-tuple-element.2727, u32[128]{0:T(256)} %get-tuple-element.2728, u32[128]{0:T(256)} %get-tuple-element.2729), kind=kOutput, calls=%fused_computation.73.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,294243.045716,1.8866813226381463,294243.045716,1.8866813226381463,0.0015252135655128014,0.91735152219906069,0,2397.8781926319421,52.0641474586249,42.893203883495147,HBM,No,No
76,convolution fusion,"%fusion.1235 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.404, f32[128]{0:T(256)} %get-tuple-element.2709, u32[128]{0:T(256)} %get-tuple-element.2710, u32[128]{0:T(256)} %get-tuple-element.2711), kind=kOutput, calls=%fused_computation.85.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,289476.902861,1.8561208970427934,289476.902861,1.8561208970427934,0.0015005081872771701,0.91885203038633789,0,2437.3584755215957,52.921366677011896,42.893203883495147,HBM,No,No
77,convolution fusion,"%fusion.1250 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.404, f32[128]{0:T(256)} %get-tuple-element.2718, u32[128]{0:T(256)} %get-tuple-element.2719, u32[128]{0:T(256)} %get-tuple-element.2720), kind=kOutput, calls=%fused_computation.79.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,289259.011428,1.8547237809410226,289259.011428,1.8547237809410226,0.0014993787435256213,0.92035140912986346,0,2439.1944754731421,52.961230992265712,42.893203883495147,HBM,No,No
78,convolution fusion,"%fusion.1210 = bf16[128,1,128]{2,0,1:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.404, f32[128]{0:T(256)} %get-tuple-element.2676, u32[128]{0:T(256)} %get-tuple-element.2677, u32[128]{0:T(256)} %get-tuple-element.2678), kind=kOutput, calls=%fused_computation.95.clone",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155958,289145.528568,1.8539961308044475,289145.528568,1.8539961308044475,0.0014987905032934554,0.921850199633157,0,2440.1518022785872,52.982017037244127,42.893203883495147,HBM,No,No
79,convolution fusion,"%fusion.1369 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2730, u32[128]{0:T(256)} %get-tuple-element.2731, u32[128]{0:T(256)} %get-tuple-element.2732, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.97.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,155975,283576.477142,1.8180892908607147,283576.477142,1.8180892908607147,0.0014699232355512232,0.92332012286870813,0,2479.3325733006222,51.930209257745666,44.464646464646464,HBM,No,No
80,convolution fusion,"%fusion.1203 = f32[128,512]{1,0:T(8,128)} fusion(f32[128,13]{0,1:T(8,128)} %get-tuple-element.2687, f32[13,512]{1,0:T(8,128)} %get-tuple-element.3561, f32[512]{0:T(512)} %get-tuple-element.3560), kind=kOutput, calls=%fused_computation.34.clone",while/bottom_mlp_layer_0/MatMul:MatMul,155954,280162.570003,1.7964436308334506,280162.570003,1.7964436308334506,0.0014522271929238318,0.92477235006163194,0,1021.4670633159011,158.1986439260217,6.0134228187919465,HBM,No,No
81,convolution fusion,"%fusion.1327 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2724, u32[128]{0:T(256)} %get-tuple-element.2725, u32[128]{0:T(256)} %get-tuple-element.2726, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.111.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,279145.895715,2.0452646150098182,279145.895715,2.0452646150098182,0.0014469572453810026,0.926219307307013,0,2203.9436691561605,46.1621232923986,44.464646464646464,HBM,No,No
82,convolution fusion,"%fusion.1303 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2703, u32[128]{0:T(256)} %get-tuple-element.2704, u32[128]{0:T(256)} %get-tuple-element.2705, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.119.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,274744.827148,2.0130185746900735,274744.827148,2.0130185746900735,0.0014241442355958222,0.92764345154260874,0,2239.2480907405447,46.901582782562947,44.464646464646464,HBM,No,No
83,convolution fusion,"%fusion.1339 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2700, u32[128]{0:T(256)} %get-tuple-element.2701, u32[128]{0:T(256)} %get-tuple-element.2702, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.107.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,274720.879998,2.0128431171272823,274720.879998,2.0128431171272823,0.0014240201051581886,0.92906747164776693,0,2239.4432838031053,46.905671147590525,44.464646464646464,HBM,No,No
84,convolution fusion,"%fusion.1351 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2715, u32[128]{0:T(256)} %get-tuple-element.2716, u32[128]{0:T(256)} %get-tuple-element.2717, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.103.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,273685.589997,2.0052576858606139,273685.589997,2.0052576858606139,0.0014186536627672644,0.93048612531053421,0,2247.9145856336236,47.083104575232191,44.464646464646464,HBM,No,No
85,convolution fusion,"%fusion.1205 = f32[128,128]{1,0:T(8,128)} fusion(f32[128,256]{1,0:T(8,128)} %fusion.1204, f32[256,128]{1,0:T(8,128)} %get-tuple-element.3565, f32[128]{0:T(256)} %get-tuple-element.3564), kind=kOutput, calls=%fused_computation.136.clone",while/bottom_mlp_layer_2/MatMul:MatMul,155954,273606.495714,1.7544051176244277,273606.495714,1.7544051176244277,0.0014182436762777196,0.931904368986812,0,4800.1319167394249,174.49188473590613,25.619937694704049,HBM,No,No
86,convolution fusion,"%fusion.1357 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2721, u32[128]{0:T(256)} %get-tuple-element.2722, u32[128]{0:T(256)} %get-tuple-element.2723, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.101.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,155975,273508.711427,1.7535419870299727,273508.711427,1.7535419870299727,0.0014177368098514851,0.93332210579666341,0,2570.5959899111058,53.841743181510473,44.464646464646464,HBM,No,No
87,convolution fusion,"%fusion.1315 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2712, u32[128]{0:T(256)} %get-tuple-element.2713, u32[128]{0:T(256)} %get-tuple-element.2714, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.115.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,270023.958573,1.9784294025160456,270023.958573,1.9784294025160456,0.0013996735373195993,0.934721779333983,0,2278.3971943944262,47.721570051270817,44.464646464646464,HBM,No,No
88,unknown,,,58514,266539.664284,4.55514345770243,266539.664284,4.55514345770243,0.0013816126417667751,0.93610339197574977,0,0,0,0,Unknown,No,No
89,unknown,,,58513,262356.992856,4.4837385342744351,262356.992856,4.4837385342744351,0.0013599316970683377,0.93746332367281815,0,0,0,0,Unknown,No,No
90,convolution fusion,"%fusion.1296 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2676, u32[128]{0:T(256)} %get-tuple-element.2677, u32[128]{0:T(256)} %get-tuple-element.2678, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.121.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,255523.05143,1.8721831967849711,255523.05143,1.8721831967849711,0.0013245078516432346,0.93878783152446144,0,2407.6960031159406,50.429764291120925,44.464646464646464,HBM,No,No
91,convolution fusion,"%fusion.1321 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2718, u32[128]{0:T(256)} %get-tuple-element.2719, u32[128]{0:T(256)} %get-tuple-element.2720, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.113.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,252296.257142,1.8485409069341461,252296.257142,1.8485409069341461,0.0013077817114919834,0.94009561323595336,0,2438.4897207798626,51.074746016982161,44.464646464646464,HBM,No,No
92,convolution fusion,"%fusion.1309 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2709, u32[128]{0:T(256)} %get-tuple-element.2710, u32[128]{0:T(256)} %get-tuple-element.2711, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.117.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,251774.581431,1.8447186588244775,251774.581431,1.8447186588244775,0.0013050775970437402,0.94140069083299716,0,2443.5422596486551,51.1805726428914,44.464646464646464,HBM,No,No
93,convolution fusion,"%fusion.1333 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2697, u32[128]{0:T(256)} %get-tuple-element.2698, u32[128]{0:T(256)} %get-tuple-element.2699, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.109.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,251244.295719,1.8408333263899064,251244.295719,1.8408333263899064,0.0013023288525166709,0.94270301968551384,0,2448.699692350765,51.288596295037742,44.464646464646464,HBM,No,No
94,infeed,"%infeed.27 = ((f32[128]{0:T(256)}, f32[128,13]{0,1:T(8,128)}, s32[128,13]{0,1:T(8,128)}), token[]) infeed(token[] %after-all.29), sharding={{maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}}",,155954,241413.475714,1.547978735486105,241413.475714,1.547978735486105,0.0012513706387201323,0.943954390324234,0,0,10.473311426800546,0,HBM,No,No
95,convolution fusion,"%fusion.1375 = (f32[256]{0:T(256)}, bf16[128,256]{1,0:T(8,128)(2,1)}) fusion(bf16[128,128]{1,0:T(8,128)(2,1)} %get-tuple-element.2762, f32[256,128]{1,0:T(8,128)} %get-tuple-element.3565, f32[128,256]{1,0:T(8,128)} %fusion.1204), kind=kOutput, calls=%fused_computation.769.clone",while/training/gradients/while/bottom_mlp_layer_2/MatMul_grad/MatMul:MatMul,116982,240540.979999,2.0562221538270844,240540.979999,2.0562221538270844,0.0012468480431320817,0.94520123836736614,0,4143.2410326595627,163.72113930532811,23.568696883852692,HBM,No,No
96,convolution fusion,"%fusion.1345 = f32[8,128]{0,1:T(8,128)} fusion(f32[128]{0:T(256)} %get-tuple-element.2706, u32[128]{0:T(256)} %get-tuple-element.2707, u32[128]{0:T(256)} %get-tuple-element.2708, f32[128,1792]{0,1:T(8,128)} %bitcast.110), kind=kOutput, calls=%fused_computation.105.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,235310.837146,1.7240910080742065,235310.837146,1.7240910080742065,0.0012197375134352648,0.94642097588080143,0,2614.5069946365538,54.761469598477078,44.464646464646464,HBM,No,No
97,loop fusion,"%fusion.1280 = (f32[256]{0:T(256)}, pred[128,256]{1,0:T(8,128)(4,1)}) fusion(f32[128]{0:T(256)} %bitcast.107, f32[256]{0:T(256)} %reduce.37, f32[128,256]{1,0:T(8,128)} %get-tuple-element.2741, f32[256]{0:T(256)} %get-tuple-element.3572), kind=kLoop, calls=%fused_computation.57.clone",while/training/gradients/while/top_mlp_layer_3/BiasAdd_grad/BiasAddGrad:,155964,228348.581432,1.46411082962735,228348.581432,1.46411082962735,0.0011836485488321352,0.94760462442963356,0,134.11006600502785,106.82428182674738,1.1692073170731707,HBM,No,No
98,convolution fusion,"%fusion.1479 = bf16[128,1024]{1,0:T(8,128)(2,1)} fusion(bf16[1024,1024]{1,0:T(8,128)(2,1)} %get-tuple-element.3695, f32[1024]{0:T(1024)} %get-tuple-element.3694, bf16[857,1024]{1,0:T(8,128)(2,1)} %get-tuple-element.3693, bf16[128,729]{0,1:T(8,128)(2,1)} %reshape.420, bf16[128,128]{0,1:T(8,128)(2,1)} %fusion.1406, f32[1024]{0:T(1024)} %get-tuple-element.3692), kind=kOutput, calls=%fused_computation.528.clone",top_mlp_layer_1/MatMul:MatMul,10934,221207.371427,20.23114792637644,221207.371427,20.23114792637644,0.0011466319717799982,0.94875125640141356,0,24404.292321757071,200.62321255183932,113.2883282424812,HBM,No,No
99,loop fusion,"%fusion.1374 = (f32[128]{0:T(256)}, bf16[128,128]{1,0:T(8,128)(2,1)}) fusion(f32[128,1792]{1,0:T(8,128)} %copy.159, f32[128,857]{1,0:T(8,128)} %copy.160, f32[128,128]{1,0:T(8,128)} %fusion.1205), kind=kLoop, calls=%fused_computation.766.clone",while/training/gradients/while/bottom_mlp_layer_2/BiasAdd_grad/BiasAddGrad:,136484,216833.754289,1.5887118950866035,216833.754289,1.5887118950866035,0.0011239612569190756,0.9498752176583326,0,51.483217475086235,135.06333140310946,0.355,HBM,No,No
100,loop fusion,"%fusion.1279 = (f32[]{:T(256)}, f32[128,1]{0,1:T(2,128)}) fusion(f32[128]{0:T(256)} %get-tuple-element.2681, f32[128]{0:T(256)} %get-tuple-element.2738, f32[]{:T(256)} %bitcast.104), kind=kLoop, calls=%fused_computation.765.clone",,155964,205294.482856,1.316294034879844,205294.482856,1.316294034879844,0.0010641472576351872,0.95093936491596776,0,1.6523663728359459,3.6225732667993698,0.4248046875,HBM,No,No
101,convolution,"%convolution.403 = f32[256,128]{1,0:T(8,128)} convolution(f32[128,256]{1,0:T(8,128)} %fusion.1204, bf16[128,128]{1,0:T(8,128)(2,1)} %get-tuple-element.2762), dim_labels=fb_io->bf",while/training/gradients/while/bottom_mlp_layer_2/MatMul_grad/MatMul_1:MatMul,116982,194907.30143,1.6661306989964266,194907.30143,1.6661306989964266,0.0010103051354540943,0.95194967005142184,0,5034.7838888346359,164.84793377183513,28.444444444444443,HBM,No,No
102,unknown,,,19492,188059.225715,9.6480210196490876,188059.225715,9.6480210196490876,0.00097480802471436269,0.95292447807613623,0,0,0,0,Unknown,No,No
103,loop fusion,"%fusion.1381 = f32[256]{0:T(256)} fusion(f32[128,256]{1,0:T(8,128)} %get-tuple-element.2741, f32[256]{0:T(256)} %get-tuple-element.3572, f32[128]{0:T(256)} %bitcast.107), kind=kLoop, calls=%fused_computation.51.clone",,155964,184123.05143,1.1805484049524249,184123.05143,1.1805484049524249,0.00095440480192588188,0.95387888287806211,0,110.80951823002273,105.82483100599205,0.97519083969465647,HBM,No,No
104,loop fusion,"%fusion.1316 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1315, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2749), kind=kLoop, calls=%fused_computation.38.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,181885.004288,1.332647081621289,181885.004288,1.332647081621289,0.00094280384852720681,0.95482168672658929,0,13.062723237139087,183.19975961043198,0.06640625,HBM,No,No
105,loop fusion,"%fusion.1346 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1345, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2754), kind=kLoop, calls=%fused_computation.43.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,175193.344286,1.2836181844465286,175193.344286,1.2836181844465286,0.00090811752115449213,0.95572980424774379,0,13.561665151624503,190.19723151073353,0.06640625,HBM,No,No
106,loop fusion,"%fusion.1310 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1309, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2748), kind=kLoop, calls=%fused_computation.37.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,174815.912859,1.2808527948990358,174815.912859,1.2808527948990358,0.00090616109927505416,0.95663596534701889,0,13.590945086997447,190.60787154530777,0.06640625,HBM,No,No
107,loop fusion,"%fusion.1304 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1303, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2747), kind=kLoop, calls=%fused_computation.36.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,171990.657145,1.2601525244350986,171990.657145,1.2601525244350986,0.00089151634078790047,0.95752748168780677,0,13.814200791133327,193.73894847213614,0.06640625,HBM,No,No
108,loop fusion,"%fusion.1352 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1351, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2755), kind=kLoop, calls=%fused_computation.44.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,170145.464285,1.2466330433237596,170145.464285,1.2466330433237596,0.000881951753885902,0.95840943344169272,0,13.964012981387834,195.84000785639273,0.06640625,HBM,No,No
109,loop fusion,"%fusion.1328 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1327, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2751), kind=kLoop, calls=%fused_computation.40.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,169790.388572,1.2440314511004953,169790.388572,1.2440314511004953,0.00088011121320996557,0.95928954465490268,0,13.993215352072115,196.24956007550463,0.06640625,HBM,No,No
110,loop fusion,"%fusion.1358 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1357, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2756), kind=kLoop, calls=%fused_computation.45.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,169732.439997,1.2436068696477243,169732.439997,1.2436068696477243,0.0008798108358383371,0.960169355490741,0,13.997992794082226,196.31656189525665,0.06640625,HBM,No,No
111,data formatting,"%copy.152 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(f32[128,128]{1,0:T(8,128)} %fusion.1205)",while/bottom_mlp_layer_2/Relu:,155954,168554.487141,1.080796177981969,168554.487141,1.080796177981969,0.00087370489824129406,0.96104306038898235,0,0,84.708603009131679,0,HBM,No,No
112,loop fusion,"%fusion.1364 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1363, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2757), kind=kLoop, calls=%fused_computation.46.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,168542.114288,1.2348855124996336,168542.114288,1.2348855124996336,0.00087364076335853509,0.96191670115234085,0,14.09685337125952,197.70304415052914,0.06640625,HBM,No,No
113,loop fusion,"%fusion.1322 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1321, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2750), kind=kLoop, calls=%fused_computation.39.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,167516.558572,1.2273714030362535,167516.558572,1.2273714030362535,0.00086832477879065454,0.96278502593113147,0,14.183155935470181,198.91340501710593,0.06640625,HBM,No,No
114,unknown,,,38995,167219.161429,4.2882205777407361,167219.161429,4.2882205777407361,0.00086678321591108132,0.96365180914704252,0,0,0,0,Unknown,No,No
115,loop fusion,"%fusion.1298 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1296, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2746), kind=kLoop, calls=%fused_computation.35.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,166050.594286,1.216630478927933,166050.594286,1.216630478927933,0.00086072592930850722,0.964512535076351,0,14.308370784315326,200.66949597851186,0.06640625,HBM,No,No
116,loop fusion,"%fusion.1334 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1333, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2752), kind=kLoop, calls=%fused_computation.41.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,165449.024286,1.2122228560563875,165449.024286,1.2122228560563875,0.0008576076815267359,0.9653701427578778,0,14.360395791110419,201.3991270489685,0.06640625,HBM,No,No
117,convolution,"%convolution.401 = f32[13,512]{1,0:T(8,128)} convolution(f32[128,13]{0,1:T(8,128)} %get-tuple-element.2687, bf16[128,512]{1,0:T(8,128)(2,1)} %get-tuple-element.2765), dim_labels=fb_io->bf",while/training/gradients/while/bottom_mlp_layer_0/MatMul_grad/MatMul_1:MatMul,116982,160926.66857,1.3756532506710435,160926.66857,1.3756532506710435,0.0008341659778516897,0.96620430873572949,0,1238.6377156953035,116.46632977979993,9.9047619047619051,HBM,No,No
118,unknown,,,19492,160707.085714,8.2447714813256709,160707.085714,8.2447714813256709,0.00083302776658178423,0.96703733650231127,0,0,0,0,Unknown,No,No
119,loop fusion,"%fusion.1340 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1339, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2753), kind=kLoop, calls=%fused_computation.42.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,155052.680001,1.1360502330016706,155052.680001,1.1360502330016706,0.00080371806351847166,0.96784105456582969,0,15.323266079532949,214.90301916799558,0.06640625,HBM,No,No
120,data formatting,"%copy.148 = s32[128,13]{1,0:T(8,128)} copy(s32[128,13]{0,1:T(8,128)} %add.434)",while/add:AddV2,155954,154138.392857,0.9883580597932724,154138.392857,0.9883580597932724,0.00079897884138525356,0.96864003340721494,0,0,69.473355430731388,0,HBM,No,No
121,unknown,,,19492,153815.76143,7.8912251913605589,153815.76143,7.8912251913605589,0.00079730647618823176,0.96943733988340319,0,0,0,0,Unknown,No,No
122,loop fusion,"%fusion.1370 = f32[136,128]{0,1:T(8,128)} fusion(f32[8,128]{0,1:T(8,128)} %fusion.1369, f32[128,128]{0,1:T(8,128)} %get-tuple-element.2758), kind=kLoop, calls=%fused_computation.47.clone, sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,136484,152779.895712,1.11939784672196,152779.895712,1.11939784672196,0.00079193704955896765,0.97022927693296213,0,15.551218050827517,218.0999594679445,0.06640625,HBM,No,No
123,unknown,,,19492,150932.702857,7.7433153528114094,150932.702857,7.7433153528114094,0.00078236209565068192,0.97101163902861276,0,0,0,0,Unknown,No,No
124,loop fusion,"%fusion.1388 = f32[256,128]{1,0:T(8,128)} fusion(f32[256,128]{1,0:T(8,128)} %get-tuple-element.3565, f32[256,128]{1,0:T(8,128)} %get-tuple-element.2792, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.59.clone",while/training/train/update_bottom_mlp_layer_2/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,148200.865716,1.5200088791384616,148200.865716,1.5200088791384616,0.00076820157384094475,0.9717798406024537,0,43.115537612612961,241.55425461879847,0.16623376623376623,HBM,No,No
125,convolution fusion,"%fusion.1474 = bf16[128,27,27]{2,1,0:T(8,128)(2,1)} fusion(pred[128,27,27]{2,1,0:T(8,128)(4,1)} %get-tuple-element.3706, bf16[128,27,128]{2,1,0:T(8,128)(2,1)} %copy.176), kind=kOutput, calls=%fused_computation.525.clone",MatMul:BatchMatMulV2,10939,146605.644289,13.402106617515312,146605.644289,13.402106617515312,0.00075993271788706278,0.97253977332034081,0,1789.3592913713142,182.16585792527172,9.148095703125,HBM,No,No
126,unknown,,,38996,137486.532856,3.5256573201353985,137486.532856,3.5256573201353985,0.000712663656933762,0.97325243697727459,0,0,0,0,Unknown,No,No
127,unknown,,,19492,116308.401428,5.9669813989328953,116308.401428,5.9669813989328953,0.000602886471656203,0.97385532344893078,0,0,0,0,Unknown,No,No
128,infeed,"%infeed.30 = ((f32[816,128]{1,0:T(8,128)}, f32[952,128]{1,0:T(8,128)}), token[]) infeed(token[] %get-tuple-element.3703), infeed_config=""\n(\n\033\010\210\001\022\002\006\007\030\200\340\035\""\016\n\006\010\001\020\001\030\002\022\000\022\002\030\001\022\t\010\200\370\304\004\030\001 \001\""\007\010\""\020\300\361\333\007\""\007\010\035\020\300\361\333\007\""\007\010)\020\300\361\333\007\""\007\0105\020\300\361\333\007\""\007\010\004\020\300\361\333\007\""\007\010\020\020\300\361\333\007\""\007\010<\020\300\361\333\007\""\007\010\037\020\300\361\333\007\""\007\010+\020\300\361\333\007\""\007\0107\020\300\361\333\007\""\007\010\006\020\300\361\333\007\""\007\010\022\020\300\361\333\007\""\007\010>\020\300\361\333\007\""\007\010\r\020\300\361\333\007\""\007\010\031\020\300\361\333\007\""\007\010%\020\300\361\333\007\""\007\0101\020\300\361\333\007\""\007\010\000\020\300\361\333\007\""\007\010,\020\300\361\333\007\""\007\0108\020\300\361\333\007\""\007\010\017\020\300\361\333\007\""\007\010\033\020\300\361\333\007\""\007\010\'\020\300\361\333\007\""\007\0103\020\300\361\333\007\""\007\010\002\020\300\361\333\007\""\007\010.\020\300\361\333\007\""\007\010:\020\300\361\333\007\""\007\010\t\020\300\361\333\007\""\007\010\025\020\300\361\333\007\""\007\010!\020\300\361\333\007\""\007\010\034\020\300\361\333\007\""\007\010(\020\300\361\333\007\""\007\0104\020\300\361\333\007\""\007\010\013\020\300\361\333\007\""\007\010\027\020\300\361\333\007\""\007\010#\020\300\361\333\007\""\007\010\036\020\300\361\333\007\""\007\010*\020\300\361\333\007\""\007\0106\020\300\361\333\007\""\007\010\005\020\300\361\333\007\""\007\010\021\020\300\361\333\007\""\007\010=\020\300\361\333\007\""\007\010\014\020\300\361\333\007\""\007\010\030\020\300\361\333\007\""\007\010$\020\300\361\333\007\""\007\0100\020\300\361\333\007\""\007\010\007\020\300\361\333\007\""\007\010\023\020\300\361\333\007\""\007\010?\020\300\361\333\007\""\007\010\016\020\300\361\333\007\""\007\010\032\020\300\361\333\007\""\007\010&\020\300\361\333\007\""\007\0102\020\300\361\333\007\""\007\010\001\020\300\361\333\007\""\007\010-\020\300\361\333\007\""\007\0109\020\300\361\333\007\""\007\010\010\020\300\361\333\007\""\007\010\024\020\300\361\333\007\""\007\010 \020\300\361\333\007\""\007\010\003\020\300\361\333\007\""\007\010/\020\300\361\333\007\""\007\010;\020\300\361\333\007\""\007\010\n\020\300\361\333\007\""\007\010\026\020\300\361\333\007""",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10964,114401.821434,10.434314249726377,114401.821434,10.434314249726377,0.00059300368355663029,0.97444832713248741,0,0,80.795735639289688,0,HBM,No,No
129,concatenate,"%concatenate.221 = bf16[128,14,128]{0,2,1:T(8,128)(2,1)} concatenate(bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.119, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.120, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.121, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.122, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.123, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.124, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.125, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.126, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.127, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.128, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.129, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.130, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.131, bf16[128,1,128]{0,2,1:T(8,128)(2,1)} %bitcast.132), dimensions={1}",concat:ConcatV2,10948,112159.051427,10.244706926105225,112159.051427,10.244706926105225,0.00058137824911117777,0.97502970538159861,0,0,83.408163225985959,0,HBM,No,No
130,data formatting,"%copy.176 = bf16[128,27,128]{2,1,0:T(8,128)(2,1)} copy(bf16[128,27,128]{0,2,1:T(8,128)(2,1)} %fusion.1472)",concat_1:ConcatV2,10942,109316.46286,9.99053764028514,109316.46286,9.99053764028514,0.00056664364550139661,0.9755963490271,0,0,180.22424560056203,0,HBM,No,No
131,unknown,,,19492,108139.824285,5.5479080794685,108139.824285,5.5479080794685,0.00056054452050108034,0.976156893547601,0,0,0,0,Unknown,No,No
132,unknown,,,19492,100991.105715,5.1811566650420682,100991.105715,5.1811566650420682,0.00052348902268135942,0.97668038257028245,0,0,0,0,Unknown,No,No
133,non-fusion elementwise,"%add.434 = s32[128,13]{0,1:T(8,128)} add(s32[128,13]{0,1:T(8,128)} %get-tuple-element.2686, s32[128,13]{0,1:T(8,128)} %get-tuple-element.3579)",while/add:AddV2,155954,95172.987148,0.61026320035395054,95172.987148,0.61026320035395054,0.00049333071140315421,0.97717371328168556,0,2.7266923501775722,37.505429756112271,0.067708333333333329,HBM,No,No
134,data formatting,"%copy.177 = bf16[128,27,27]{0,2,1:T(8,128)(2,1)} copy(bf16[128,27,27]{2,1,0:T(8,128)(2,1)} %fusion.1474)",Select:Select,10936,93620.941428,8.5608029835406,93620.941428,8.5608029835406,0.000485285657421743,0.97765899893910735,0,0,138.1361251520951,0,HBM,No,No
135,convolution fusion,"%fusion.1484 = f32[128]{0:T(256)} fusion(bf16[512,256]{1,0:T(8,128)(2,1)} %get-tuple-element.3699, bf16[128,1024]{1,0:T(8,128)(2,1)} %fusion.1479, bf16[1024,512]{1,0:T(8,128)(2,1)} %get-tuple-element.3697, f32[512]{0:T(512)} %get-tuple-element.3696, f32[256]{0:T(256)} %get-tuple-element.3698, f32[256]{0:T(256)} %reduce.48), kind=kOutput, calls=%fused_computation.546.clone",top_mlp_layer_3/MatMul:MatMul,10933,92929.85429,8.4999409393579075,92929.85429,8.4999409393579075,0.00048170339611370043,0.9781407023352211,0,19768.863948446851,172.89674505484291,106.48661583387411,HBM,No,No
136,unknown,,,58513,89045.702858,1.5218105866730471,89045.702858,1.5218105866730471,0.00046156983462144238,0.97860227216984252,0,0,0,0,Unknown,No,No
137,unknown,,,38995,79754.027145,2.0452372649057571,79754.027145,2.0452372649057571,0.000413406283944048,0.97901567845378656,0,0,0,0,Unknown,No,No
138,data formatting,"%reshape.413 = f32[256,1]{0,1:T(2,128)} reshape(f32[256]{0:T(256)} %fusion.1381)",while/training/gradients/while/top_mlp_layer_4/MatMul_grad/MatMul_1:MatMul,155964,77967.559999,0.49990741452514686,77967.559999,0.49990741452514686,0.00040414610272619851,0.97941982455651277,0,0,5.7231056513125633,0,HBM,No,No
139,reduce,"%reduce.37 = f32[256]{0:T(256)} reduce(f32[256,1]{0,1:T(2,128)} %get-tuple-element.3575, f32[] %get-tuple-element.3577), dimensions={1}, to_apply=%get-tuple-element.798.reduce_sub_computation",,155954,77668.801428,0.49802378539825848,77668.801428,0.49802378539825848,0.00040259748286266493,0.97982242203937542,0,0,13.404420452461032,0,HBM,No,No
140,loop fusion,"%fusion.1201 = s32[2048]{0} fusion(s32[1664]{0:T(1024)} %reshape.400), kind=kLoop, calls=%fused_computation.294.clone",while/Gather:ResourceGather,155954,77403.728573,0.49632409924080179,77403.728573,0.49632409924080179,0.00040122347345044105,0.98022364551282581,0,4.1263360032944343,30.74359896235288,0.125,HBM,No,No
141,loop fusion,"%fusion.1384 = f32[13,512]{1,0:T(8,128)} fusion(f32[13,512]{1,0:T(8,128)} %get-tuple-element.3561, f32[13,512]{1,0:T(8,128)} %get-tuple-element.2788, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.293.clone",while/training/train/update_bottom_mlp_layer_0/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,73029.977141,0.7490254065743589,73029.977141,0.7490254065743589,0.00037855206247440688,0.98060219757530021,0,17.772427855127049,123.50236437764755,0.13402061855670103,HBM,No,No
142,loop fusion,"%fusion.1472 = bf16[128,27,128]{0,2,1:T(8,128)(2,1)} fusion(bf16[128,13,128]{0,2,1:T(8,128)(2,1)} %copy.162, bf16[128,14,128]{0,2,1:T(8,128)(2,1)} %concatenate.221), kind=kLoop, calls=%fused_computation.526.clone",concat_1:ConcatV2,10945,65757.62143,6.0080056126084971,65757.62143,6.0080056126084971,0.00034085568954344739,0.98094305326484366,0,73.629758113347862,274.29222357613867,0.25,HBM,No,No
143,unknown,,,38995,64707.342856,1.6593753777663804,64707.342856,1.6593753777663804,0.00033541155364302458,0.98127846481848668,0,0,0,0,Unknown,No,No
144,data formatting,"%copy.162 = bf16[128,13,128]{0,2,1:T(8,128)(2,1)} copy(bf16[128,13,128]{2,1,0:T(8,128)(2,1)} %reshape.417)",,10987,60570.372854,5.5129127927550741,60570.372854,5.5129127927550741,0.00031396750302216457,0.98159243232150883,0,0,160.53396795662186,0,HBM,No,No
145,unknown,,,38996,53831.495715,1.3804363451379629,53831.495715,1.3804363451379629,0.00027903642485949722,0.98187146874636833,0,0,0,0,Unknown,No,No
146,loop fusion,"%fusion.1387 = f32[128]{0:T(256)} fusion(f32[128]{0:T(256)} %get-tuple-element.3564, f32[128]{0:T(256)} %get-tuple-element.2791, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.454.clone",while/training/train/update_bottom_mlp_layer_2/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,50798.781428,0.52101314285128209,50798.781428,0.52101314285128209,0.00026331630151859968,0.98213478504788687,0,0.49135036901184775,7.3216910512590019,0.0625,HBM,No,No
147,loop fusion,"%fusion.1391 = f32[1024]{0:T(1024)} fusion(f32[1024]{0:T(1024)} %get-tuple-element.3568, f32[1024]{0:T(1024)} %get-tuple-element.2795, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.312.clone",while/training/train/update_top_mlp_layer_1/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,50723.844282,0.52024455673846148,50723.844282,0.52024455673846148,0.00026292786361563445,0.98239771291150246,0,3.9366101451198365,23.830650321327539,0.15384615384615385,HBM,No,No
148,unknown,,,19492,50583.02,2.5950656679663449,50583.02,2.5950656679663449,0.00026219789868226672,0.98265991081018478,0,0,0,0,Unknown,No,No
149,unknown,,,19492,49140.594286,2.5210647591832545,49140.594286,2.5210647591832545,0.00025472106176711081,0.98291463187195194,0,0,0,0,Unknown,No,No
150,loop fusion,"%fusion.1389 = f32[1024]{0:T(1024)} fusion(f32[1024]{0:T(1024)} %get-tuple-element.3566, f32[1024]{0:T(1024)} %get-tuple-element.2793, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.313.clone",while/training/train/update_top_mlp_layer_0/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,48870.688573,0.50123783151794876,48870.688573,0.50123783151794876,0.00025332200115762293,0.98316795387310951,0,4.0858847262143732,24.734298438054694,0.15384615384615385,HBM,No,No
151,loop fusion,"%fusion.1385 = f32[256]{0:T(256)} fusion(f32[256]{0:T(256)} %get-tuple-element.3562, f32[256]{0:T(256)} %get-tuple-element.2789, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.455.clone",while/training/train/update_bottom_mlp_layer_1/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,47989.318573,0.4921981392102564,47989.318573,0.4921981392102564,0.00024875340557037665,0.98341670727867991,0,1.0402314824300558,7.7503284992570922,0.125,HBM,No,No
152,loop fusion,"%fusion.1397 = f32[256,1]{0,1:T(2,128)} fusion(f32[256,1]{0,1:T(2,128)} %get-tuple-element.3575, f32[256,1]{0,1:T(2,128)} %get-tuple-element.2802, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.444.clone",while/training/train/update_top_mlp_layer_4/kernel/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,46648.26286,0.47844372164102567,46648.26286,0.47844372164102567,0.00024180202168771312,0.98365850930036758,0,1.0701363124671777,13.952989479948167,0.071428571428571425,HBM,No,No
153,loop fusion,"%fusion.1383 = f32[512]{0:T(512)} fusion(f32[512]{0:T(512)} %get-tuple-element.3560, f32[512]{0:T(512)} %get-tuple-element.2787, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.446.clone",while/training/train/update_bottom_mlp_layer_0/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,46234.412857,0.47419910622564104,46234.412857,0.47419910622564104,0.00023965682353314959,0.98389816612390069,0,2.159430472466441,14.077884431161142,0.14285714285714285,HBM,No,No
154,loop fusion,"%fusion.1393 = f32[512]{0:T(512)} fusion(f32[512]{0:T(512)} %get-tuple-element.3570, f32[512]{0:T(512)} %get-tuple-element.2797, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.445.clone",while/training/train/update_top_mlp_layer_2/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,45980.157145,0.4715913553333333,45980.157145,0.4715913553333333,0.00023833888495584905,0.98413650500885652,0,2.1713714393178591,14.15573067510091,0.14285714285714285,HBM,No,No
155,loop fusion,"%fusion.1395 = f32[256]{0:T(256)} fusion(f32[256]{0:T(256)} %get-tuple-element.3572, f32[256]{0:T(256)} %get-tuple-element.2799, f32[]{:T(256)S(5)} %add.473), kind=kLoop, calls=%fused_computation.453.clone",while/training/train/update_top_mlp_layer_3/bias/ResourceApplyGradientDescent:ResourceApplyGradientDescent,97500,45530.597143,0.46698048351794869,45530.597143,0.46698048351794869,0.00023600858344644934,0.98437251359230293,0,1.0964055631252541,8.168858014932308,0.125,HBM,No,No
156,unknown,,,58513,43494.362856,0.74332819810982176,43494.362856,0.74332819810982176,0.00022545373023135496,0.98459796732253424,0,0,0,0,Unknown,No,No
157,data formatting,"%reshape.419 = f32[136,896]{1,0:T(8,128)} reshape(f32[952,128]{1,0:T(8,128)} %get-tuple-element.2991)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10953,38803.938571,3.5427680608965577,38803.938571,3.5427680608965577,0.00020114084042257579,0.98479910816295679,0,0,256.26796155084736,0,HBM,No,No
158,unknown,,,19492,38796.122858,1.9903613204391546,38796.122858,1.9903613204391546,0.00020110032754838792,0.98500020849050518,0,0,0,0,Unknown,No,No
159,unknown,,,19492,38719.302857,1.9864202163451674,38719.302857,1.9864202163451674,0.00020070212983621158,0.98520091062034143,0,0,0,0,Unknown,No,No
160,unknown,,,19492,38180.247142,1.9587649877898625,38180.247142,1.9587649877898625,0.00019790792585737307,0.98539881854619882,0,0,0,0,Unknown,No,No
161,unknown,,,19492,38042.362858,1.9516910967576442,38042.362858,1.9516910967576442,0.00019719320045097962,0.98559601174664979,0,0,0,0,Unknown,No,No
162,unknown,,,19492,37580.524285,1.9279973468602503,37580.524285,1.9279973468602503,0.00019479925277108591,0.9857908109994209,0,0,0,0,Unknown,No,No
163,unknown,,,19492,37452.815714,1.9214455014364866,37452.815714,1.9214455014364866,0.00019413727333688217,0.98598494827275773,0,0,0,0,Unknown,No,No
164,unknown,,,19492,36772.838572,1.886560567001847,36772.838572,1.886560567001847,0.0001906126008720042,0.98617556087362979,0,0,0,0,Unknown,No,No
165,unknown,,,19492,36753.589999,1.885573055561256,36753.589999,1.885573055561256,0.00019051282558390888,0.9863660736992137,0,0,0,0,Unknown,No,No
166,data formatting,"%reshape.418 = f32[136,768]{1,0:T(8,128)} reshape(f32[816,128]{1,0:T(8,128)} %get-tuple-element.2984)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10964,36575.354284,3.3359498617292958,36575.354284,3.3359498617292958,0.00018958893788516862,0.98655566263709882,0,0,233.27636038855763,0,HBM,No,No
167,unknown,,,19492,36503.897142,1.8727630382721117,36503.897142,1.8727630382721117,0.00018921853863897414,0.98674488117573778,0,0,0,0,Unknown,No,No
168,data formatting,"%reshape.417 = bf16[128,13,128]{2,1,0:T(8,128)(2,1)} reshape(bf16[1664,128]{1,0:T(8,128)(2,1)} %fusion.1399)",,10990,35801.284288,3.2576236840764334,35801.284288,3.2576236840764334,0.00018557653359645295,0.98693045770933419,0,0,271.6734194762285,0,HBM,No,No
169,unknown,,,19492,33624.415715,1.7250367183972914,33624.415715,1.7250367183972914,0.00017429270029531625,0.98710475040962953,0,0,0,0,Unknown,No,No
170,unknown,,,19492,32057.827141,1.6446658701518573,32057.827141,1.6446658701518573,0.0001661722631960199,0.98727092267282557,0,0,0,0,Unknown,No,No
171,unknown,,,58513,30433.347145,0.52011257575239689,30433.347145,0.52011257575239689,0.00015775174497859086,0.98742867441780413,0,0,0,0,Unknown,No,No
172,unknown,,,58512,30266.628572,0.51727215907847968,30266.628572,0.51727215907847968,0.00015688755657086224,0.987585561974375,0,0,0,0,Unknown,No,No
173,unknown,,,58513,29172.584285,0.49856586203065989,29172.584285,0.49856586203065989,0.00015121656039236716,0.98773677853476738,0,0,0,0,Unknown,No,No
174,convolution fusion,"%fusion.1403 = bf16[128,256]{1,0:T(8,128)(2,1)} fusion(bf16[512,256]{1,0:T(8,128)(2,1)} %get-tuple-element.3689, f32[128,13]{0,1:T(8,128)} %get-tuple-element.2976, bf16[13,512]{1,0:T(8,128)(2,1)} %get-tuple-element.3687, f32[512]{0:T(512)} %get-tuple-element.3686, f32[256]{0:T(256)} %get-tuple-element.3688), kind=kOutput, calls=%fused_computation.542.clone",bottom_mlp_layer_1/MatMul:MatMul,10995,28653.301429,2.6060301436107323,28653.301429,2.6060301436107323,0.00014852484934654731,0.987885303384114,0,13604.975401733487,126.98432848229287,99.78097982708934,HBM,No,No
175,unknown,,,58513,28346.415714,0.48444646000034181,28346.415714,0.48444646000034181,0.00014693410230122252,0.98803223748641522,0,0,0,0,Unknown,No,No
176,unknown,,,58512,28109.215713,0.48040087012920429,28109.215713,0.48040087012920429,0.00014570457227652982,0.98817794205869181,0,0,0,0,Unknown,No,No
177,unknown,,,58512,28019.052858,0.47885994083264971,28019.052858,0.47885994083264971,0.00014523721166579139,0.98832317927035762,0,0,0,0,Unknown,No,No
178,unknown,,,58512,27919.442856,0.47715755496308454,27919.442856,0.47715755496308454,0.00014472088161645596,0.988467900151974,0,0,0,0,Unknown,No,No
179,unknown,,,58512,27367.672856,0.46772752351654362,27367.672856,0.46772752351654362,0.0001418607729365884,0.9886097609249106,0,0,0,0,Unknown,No,No
180,unknown,,,19492,26263.125715,1.3473797309152471,26263.125715,1.3473797309152471,0.0001361353350452623,0.9887458962599559,0,0,0,0,Unknown,No,No
181,unknown,,,19492,26016.081429,1.334705593525549,26016.081429,1.334705593525549,0.00013485477701075465,0.98888075103696671,0,0,0,0,Unknown,No,No
182,data formatting,"%reshape.414 = s32[1664]{0:T(1024)} reshape(s32[128,13]{1,0:T(8,128)} %copy.161)",,10995,25267.328569,2.2980744492041838,25267.328569,2.2980744492041838,0.00013097360450416376,0.98901172464147091,0,0,29.879167232647497,0,HBM,No,No
183,unknown,,,19492,25174.91,1.2915508926739174,25174.91,1.2915508926739174,0.00013049455136358374,0.98914221919283452,0,0,0,0,Unknown,No,No
184,unknown,,,19492,25166.768572,1.2911332121896162,25166.768572,1.2911332121896162,0.00013045235014044851,0.98927267154297494,0,0,0,0,Unknown,No,No
185,unknown,,,19492,24904.091429,1.277657060794172,24904.091429,1.277657060794172,0.00012909075893995355,0.9894017623019149,0,0,0,0,Unknown,No,No
186,unknown,,,19492,24699.691428,1.2671707073671248,24699.691428,1.2671707073671248,0.00012803124824342231,0.98952979355015835,0,0,0,0,Unknown,No,No
187,unknown,,,19492,24020.697143,1.2323361965421713,24020.697143,1.2323361965421713,0.00012451167043363024,0.989654305220592,0,0,0,0,Unknown,No,No
188,data formatting,"%reshape.420 = bf16[128,729]{0,1:T(8,128)(2,1)} reshape(bf16[128,27,27]{0,2,1:T(8,128)(2,1)} %copy.177)",Reshape_14:Reshape,10936,23963.298572,2.1912306667885879,23963.298572,2.1912306667885879,0.00012421414401659218,0.98977851936460859,0,0,174.08926058858435,0,HBM,No,No
189,unknown,,,19492,23927.528571,1.2275563600964499,23927.528571,1.2275563600964499,0.0001240287296404228,0.989902548094249,0,0,0,0,Unknown,No,No
190,unknown,,,19492,23781.677142,1.2200737298378823,23781.677142,1.2200737298378823,0.00012327270640963102,0.99002582080065871,0,0,0,0,Unknown,No,No
191,unknown,,,19492,23671.488571,1.2144207147034682,23671.488571,1.2144207147034682,0.00012270154217754284,0.99014852234283623,0,0,0,0,Unknown,No,No
192,unknown,,,19492,23427.480001,1.2019023189513647,23427.480001,1.2019023189513647,0.00012143671982580375,0.990269959062662,0,0,0,0,Unknown,No,No
193,unknown,,,19492,22261.801429,1.1420993961112251,22261.801429,1.1420993961112251,0.00011539440617752128,0.99038535346883949,0,0,0,0,Unknown,No,No
194,unknown,,,19492,21860.987143,1.1215363812333263,21860.987143,1.1215363812333263,0.00011331677887193468,0.99049867024771143,0,0,0,0,Unknown,No,No
195,convolution fusion,"%fusion.1466 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.3022, f32[128]{0:T(256)} %get-tuple-element.3023, u32[128]{0:T(256)} %get-tuple-element.3024), kind=kOutput, calls=%fused_computation.548.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10953,18850.881427,1.721070156760705,18850.881427,1.721070156760705,9.7713847422869755e-05,0.99059638409513429,0,2628.6156797436206,57.074056047863628,42.893203883495147,HBM,No,No
196,convolution fusion,"%fusion.1436 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.418, u32[128]{0:T(256)} %get-tuple-element.3004, f32[128]{0:T(256)} %get-tuple-element.3005, u32[128]{0:T(256)} %get-tuple-element.3006), kind=kOutput, calls=%fused_computation.554.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10956,18772.955713,1.7134862826761592,18772.955713,1.7134862826761592,9.73099182295532e-05,0.99069369401336382,0,2640.249907886202,57.326665280244107,42.893203883495147,HBM,No,No
197,convolution fusion,"%fusion.1461 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.418, u32[128]{0:T(256)} %get-tuple-element.3019, f32[128]{0:T(256)} %get-tuple-element.3020, u32[128]{0:T(256)} %get-tuple-element.3021), kind=kOutput, calls=%fused_computation.549.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10963,18565.808571,1.6934970875672719,18565.808571,1.6934970875672719,9.6236167683412679e-05,0.99078993018104722,0,2671.4141011596453,58.003320649563236,42.893203883495147,HBM,No,No
198,convolution fusion,"%fusion.1431 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.3001, f32[128]{0:T(256)} %get-tuple-element.3002, u32[128]{0:T(256)} %get-tuple-element.3003), kind=kOutput, calls=%fused_computation.555.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10951,18450.928571,1.6848624391379783,18450.928571,1.6848624391379783,9.5640685353559317e-05,0.99088557086640072,0,2685.1046678413813,58.300578318739362,42.893203883495147,HBM,No,No
199,infeed,"%infeed.29 = ((f32[128]{0:T(256)}, f32[128,13]{0,1:T(8,128)}, s32[128,13]{0,1:T(8,128)}), token[]) infeed(token[] %get-tuple-element.3702), sharding={{maximal device=0}, {maximal device=0}, {maximal device=0}, {maximal device=0}}",,10996,18388.012857,1.6722456217715533,18388.012857,1.6722456217715533,9.5314560736941054e-05,0.99098088542713769,0,0,9.69502516121742,0,HBM,No,No
200,convolution fusion,"%fusion.1426 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.418, u32[128]{0:T(256)} %get-tuple-element.2998, f32[128]{0:T(256)} %get-tuple-element.2999, u32[128]{0:T(256)} %get-tuple-element.3000), kind=kOutput, calls=%fused_computation.556.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10956,18162.798569,1.6577946850127783,18162.798569,1.6577946850127783,9.4147158848583584e-05,0.99107503258598628,0,2728.9458947475928,59.252484929102529,42.893203883495147,HBM,No,No
201,convolution fusion,"%fusion.1441 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.418, u32[128]{0:T(256)} %get-tuple-element.3007, f32[128]{0:T(256)} %get-tuple-element.3008, u32[128]{0:T(256)} %get-tuple-element.3009), kind=kOutput, calls=%fused_computation.553.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10958,17992.730003,1.6419720754699763,17992.730003,1.6419720754699763,9.3265605698196252e-05,0.9911682981916845,0,2755.2429591137238,59.823462321154466,42.893203883495147,HBM,No,No
202,convolution fusion,"%fusion.1421 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.2995, f32[128]{0:T(256)} %get-tuple-element.2996, u32[128]{0:T(256)} %get-tuple-element.2997), kind=kOutput, calls=%fused_computation.557.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10951,17738.109999,1.6197707970961557,17738.109999,1.6197707970961557,9.1945778807447719e-05,0.991260243970492,0,2793.0075095257048,60.643428542708008,42.893203883495147,HBM,No,No
203,convolution fusion,"%fusion.1451 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.418, u32[128]{0:T(256)} %get-tuple-element.3013, f32[128]{0:T(256)} %get-tuple-element.3014, u32[128]{0:T(256)} %get-tuple-element.3015), kind=kOutput, calls=%fused_computation.551.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10961,17605.768569,1.6062191925006841,17605.768569,1.6062191925006841,9.1259784874016963e-05,0.991351503755366,0,2816.57199784585,61.155074629843263,42.893203883495147,HBM,No,No
204,convolution fusion,"%fusion.1456 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.3016, f32[128]{0:T(256)} %get-tuple-element.3017, u32[128]{0:T(256)} %get-tuple-element.3018), kind=kOutput, calls=%fused_computation.550.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10952,17435.052855,1.5919515024653033,17435.052855,1.5919515024653033,9.0374877221550932e-05,0.99144187863258748,0,2841.8152142160511,61.703170251825448,42.893203883495147,HBM,No,No
205,convolution fusion,"%fusion.1446 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.3010, f32[128]{0:T(256)} %get-tuple-element.3011, u32[128]{0:T(256)} %get-tuple-element.3012), kind=kOutput, calls=%fused_computation.552.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10952,17412.535714,1.5898955180788898,17412.535714,1.5898955180788898,9.0258159258595531e-05,0.991532136791846,0,2845.4901272169759,61.782962133233632,42.893203883495147,HBM,No,No
206,convolution fusion,"%fusion.1416 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.2992, f32[128]{0:T(256)} %get-tuple-element.2993, u32[128]{0:T(256)} %get-tuple-element.2994), kind=kOutput, calls=%fused_computation.558.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10951,17307.917146,1.5804873660852889,17307.917146,1.5804873660852889,8.9715867226748723e-05,0.99162185265907277,0,2862.4284490204941,62.150736979674875,42.893203883495147,HBM,No,No
207,convolution fusion,"%fusion.1471 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,896]{1,0:T(8,128)} %reshape.419, u32[128]{0:T(256)} %get-tuple-element.3025, f32[128]{0:T(256)} %get-tuple-element.3026, u32[128]{0:T(256)} %get-tuple-element.3027), kind=kOutput, calls=%fused_computation.547.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10953,17275.897141,1.5772753712224963,17275.897141,1.5772753712224963,8.9549891015229608e-05,0.991711402550088,0,2868.2575551113605,62.2773019736764,42.893203883495147,HBM,No,No
208,convolution fusion,"%fusion.1411 = bf16[128,128]{1,0:T(8,128)(2,1)} fusion(f32[136,768]{1,0:T(8,128)} %reshape.418, u32[128]{0:T(256)} %get-tuple-element.2988, f32[128]{0:T(256)} %get-tuple-element.2989, u32[128]{0:T(256)} %get-tuple-element.2990), kind=kOutput, calls=%fused_computation.559.clone",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10956,17198.064283,1.5697393467506389,17198.064283,1.5697393467506389,8.9146443142484259e-05,0.99180054899323056,0,2882.0275221900683,62.576283631163896,42.893203883495147,HBM,No,No
209,convolution fusion,"%fusion.1406 = bf16[128,128]{0,1:T(8,128)(2,1)} fusion(bf16[128,256]{1,0:T(8,128)(2,1)} %fusion.1403, bf16[256,128]{1,0:T(8,128)(2,1)} %get-tuple-element.3691, f32[128]{0:T(256)} %get-tuple-element.3690), kind=kOutput, calls=%fused_computation.574.clone",bottom_mlp_layer_2/MatMul:MatMul,10995,16377.497144,1.4895404405638928,16377.497144,1.4895404405638928,8.4893020164308593e-05,0.9918854420133949,0,5653.67395920579,103.07982298377686,51.080745341614907,HBM,No,No
210,data formatting,"%copy.165 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1421)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10951,10640.20714,0.97161968222080175,10640.20714,0.97161968222080175,5.51536850439545e-05,0.99194059569843884,0,0,62.817949622155396,0,HBM,No,No
211,data formatting,"%copy.168 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1436)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10956,10521.464285,0.96033810560423516,10521.464285,0.96033810560423516,5.4538179543007074e-05,0.99199513387798188,0,0,63.555903794152009,0,HBM,No,No
212,data formatting,"%copy.161 = s32[128,13]{1,0:T(8,128)} copy(s32[128,13]{0,1:T(8,128)} %add.475)",add_2:AddV2,10995,10511.204287,0.95599857089586182,10511.204287,0.95599857089586182,5.4484996678162625e-05,0.99204961887466,0,0,71.824951282616311,0,HBM,No,No
213,data formatting,"%copy.164 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1416)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10951,10450.245715,0.9542731910327823,10450.245715,0.9542731910327823,5.4169016938616196e-05,0.9921037878915987,0,0,63.959835425727896,0,HBM,No,No
214,data formatting,"%copy.163 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1411)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10954,10438.02714,0.9528963976629542,10438.02714,0.9528963976629542,5.410568175835429e-05,0.992157893573357,0,0,64.052247861712985,0,HBM,No,No
215,data formatting,"%copy.173 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1461)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10962,10402.797147,0.9489871507936507,10402.797147,0.9489871507936507,5.3923066522348392e-05,0.99221181663987934,0,0,64.316103962626286,0,HBM,No,No
216,data formatting,"%copy.169 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1441)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10958,10317.737144,0.9415711940135062,10317.737144,0.9415711940135062,5.3482156627120569e-05,0.99226529879650649,0,0,64.822667300891823,0,HBM,No,No
217,data formatting,"%copy.166 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1426)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10954,10228.908572,0.93380578528391456,10228.908572,0.93380578528391456,5.3021712293797911e-05,0.99231832050880031,0,0,65.361724259487,0,HBM,No,No
218,data formatting,"%copy.171 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1451)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10959,10223.820001,0.93291541208139428,10223.820001,0.93291541208139428,5.2995335604080777e-05,0.99237131584440441,0,0,65.424105400368077,0,HBM,No,No
219,data formatting,"%copy.172 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1456)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10952,10178.001428,0.92932810701241775,10178.001428,0.92932810701241775,5.2757834293142441e-05,0.99242407367869756,0,0,65.676649386894539,0,HBM,No,No
220,data formatting,"%copy.167 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1431)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10951,10027.918571,0.91570802401607165,10027.918571,0.91570802401607165,5.1979877387176149e-05,0.9924760535560847,0,0,66.653512526793946,0,HBM,No,No
221,data formatting,"%copy.170 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1446)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10952,9978.735716,0.91113364828341847,9978.735716,0.91113364828341847,5.1724937266317511e-05,0.992527778493351,0,0,66.988148626309183,0,HBM,No,No
222,data formatting,"%copy.174 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1466)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10953,9977.838571,0.91096855391217024,9977.838571,0.91096855391217024,5.1720286900763752e-05,0.99257949878025187,0,0,67.000288854674977,0,HBM,No,No
223,data formatting,"%copy.175 = bf16[128,128]{0,1:T(8,128)(2,1)} copy(bf16[128,128]{1,0:T(8,128)(2,1)} %fusion.1471)",RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,10953,9962.971426,0.90961119565415871,9962.971426,0.90961119565415871,5.1643222815258289e-05,0.99263114200306712,0,0,67.1002693692075,0,HBM,No,No
224,loop fusion,"%fusion.1485 = f32[128,1]{0,1:T(2,128)} fusion(f32[128]{0:T(256)} %fusion.1484, f32[]{:T(256)} %bitcast.139), kind=kLoop, calls=%fused_computation.734.clone",top_mlp_layer_4/Sigmoid:,10932,8845.499999,0.80913830945847054,8845.499999,0.80913830945847054,4.585079167933809e-05,0.99267699279474642,0,0.15819297949897609,3.5358886308531208,0.041666666666666664,HBM,No,No
225,non-fusion elementwise,"%add.475 = s32[128,13]{0,1:T(8,128)} add(s32[128,13]{0,1:T(8,128)} %get-tuple-element.2974, s32[128,13]{0,1:T(8,128)} %get-tuple-element.3707)",add_2:AddV2,10995,6632.294291,0.60321003101409731,6632.294291,0.60321003101409731,3.4378604253810747e-05,0.99271137139900023,0,2.758574815479339,37.943970452773272,0.067708333333333329,HBM,No,No
226,loop fusion,"%fusion.1398 = s32[2048]{0} fusion(s32[1664]{0:T(1024)} %reshape.414), kind=kLoop, calls=%fused_computation.653.clone",Gather:ResourceGather,10995,6216.989998,0.56543792614824917,6216.989998,0.56543792614824917,3.2225867763614543e-05,0.99274359726676387,0,3.62197140533344,26.985789875031514,0.125,HBM,No,No
227,loop fusion,"%fusion.1486 = f32[1363,128,2]{1,2,0:T(2,128)} fusion(f32[1363,128,2]{1,2,0:T(2,128)} %get-tuple-element.3684, s32[]{:T(256)S(5)} %copy.281, f32[128,1]{0,1:T(2,128)} %bitcast.114, f32[128,1]{0,1:T(2,128)} %fusion.1485), kind=kLoop, calls=%fused_computation.733.clone",XlaDynamicUpdateSlice:XlaDynamicUpdateSlice,10932,5851.305718,0.53524567489937791,5851.305718,0.53524567489937791,3.0330337409809296e-05,0.99277392760417371,0,0.47828504181397824,8.9087531307929133,0.05,HBM,No,No
228,reduce,"%reduce.48 = f32[256]{0:T(256)} reduce(f32[256,1]{0,1:T(2,128)} %get-tuple-element.3701, f32[] %get-tuple-element.3708), dimensions={1}, to_apply=%get-tuple-element.2026.reduce_sub_computation",,10750,5837.66,0.54303813953488367,5837.66,0.54303813953488367,3.0259604610826343e-05,0.99280418720878449,0,0,12.293280579743966,0,HBM,No,No
229,non-fusion elementwise,"%convert.267 = bf16[19656,128]{1,0:T(8,128)(2,1)} convert(f32[19656,128]{1,0:T(8,128)} %get-tuple-element.3281)",,64,2700.994287,42.203035734375,2700.994287,42.203035734375,1.4000647379381603e-05,0.99281818785616383,0,59.615806214402404,333.12927678628853,0.16666666666666666,HBM,No,No
230,non-fusion elementwise,"%convert.272 = bf16[1024,1024]{1,0:T(8,128)(2,1)} convert(f32[1024,1024]{1,0:T(8,128)} %get-tuple-element.3304)",,64,1142.359997,17.849374953125,1142.359997,17.849374953125,5.9214414392829952e-06,0.99282410929760312,0,58.745810581810844,328.26779735162074,0.16666666666666666,HBM,No,No
231,non-fusion elementwise,"%convert.271 = bf16[857,1024]{1,0:T(8,128)(2,1)} convert(f32[857,1024]{1,0:T(8,128)} %get-tuple-element.3302)",,64,960.717142,15.01120534375,960.717142,15.01120534375,4.9798927754893412e-06,0.9928290891903786,0,58.460861729893026,329.34381636977054,0.16531635802469136,HBM,No,No
232,non-fusion elementwise,"%convert.273 = bf16[1024,512]{1,0:T(8,128)(2,1)} convert(f32[1024,512]{1,0:T(8,128)} %get-tuple-element.3306)",,64,582.16714,9.0963615625,582.16714,9.0963615625,3.0176727445270169e-06,0.99283210686312318,0,57.637110881936756,322.07245499788434,0.16666666666666666,HBM,No,No
233,non-fusion elementwise,"%convert.274 = bf16[512,256]{1,0:T(8,128)(2,1)} convert(f32[512,256]{1,0:T(8,128)} %get-tuple-element.3308)",,64,168.104281,2.626629390625,168.104281,2.626629390625,8.7137124745998338e-07,0.99283297823437067,0,49.901215781649256,278.8447725476085,0.16666666666666666,HBM,No,No
234,non-fusion elementwise,"%convert.269 = bf16[512,256]{1,0:T(8,128)(2,1)} convert(f32[512,256]{1,0:T(8,128)} %get-tuple-element.3298)",,64,164.320002,2.56750003125,164.320002,2.56750003125,8.5175537632719163e-07,0.992833829989747,0,51.050437548071592,285.26654959342233,0.16666666666666666,HBM,No,No
235,after-all,"%after-all.30 = token[] after-all(), sharding={maximal device=0}",while/RecvTPUEmbeddingActivations:_RecvTPUEmbeddingActivations,155954,157.088568,0.00100727501699219,157.088568,0.00100727501699219,8.14271121744142e-07,0.99283464426086876,0,0,0,0,Unknown,No,No
236,after-all,"%after-all.28 = token[] after-all(), sharding={maximal device=0}",RecvTPUEmbeddingDeduplicationData_cluster_TPU_REPLICATED_CORE_0:_RecvTPUEmbeddingDeduplicationData,155954,150.835709,0.00096718076484091466,150.835709,0.00096718076484091466,7.818593264310804e-07,0.99283542612019515,0,0,0,0,Unknown,No,No
237,after-all,"%after-all.29 = token[] after-all(), sharding={maximal device=0}",while/InfeedQueue/dequeue:InfeedDequeueTuple,155954,142.627142,0.00091454622516896,142.627142,0.00091454622516896,7.3931008720826213e-07,0.99283616543028241,0,0,0,0,Unknown,No,No
238,after-all,"%after-all.31 = token[] after-all(), sharding={maximal device=0}",while/SendTPUEmbeddingGradients:_SendTPUEmbeddingGradients,155954,141.870001,0.00090969132564730623,141.870001,0.00090969132564730623,7.3538543464291132e-07,0.99283690081571707,0,0,0,0,Unknown,No,No
239,non-fusion elementwise,"%convert.270 = bf16[256,128]{1,0:T(8,128)(2,1)} convert(f32[256,128]{1,0:T(8,128)} %get-tuple-element.3300)",,64,62.920001,0.983125015625,62.920001,0.983125015625,3.2614683835180503e-07,0.99283722696255539,0,33.330450837087561,186.24840771905048,0.16666666666666666,HBM,No,No
240,non-fusion elementwise,"%convert.268 = bf16[13,512]{1,0:T(8,128)(2,1)} convert(f32[13,512]{1,0:T(8,128)} %get-tuple-element.3296)",,64,39.912861,0.623638453125,39.912861,0.623638453125,2.0688895768970287e-07,0.99283743385151313,0,10.672850538075936,73.40209212220509,0.13541666666666666,HBM,No,No